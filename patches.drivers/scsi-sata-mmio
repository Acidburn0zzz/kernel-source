diff -purN linux-2.6.3/drivers/scsi/libata-core.c linuxppc-2.5-benh/drivers/scsi/libata-core.c
--- linux-2.6.3/drivers/scsi/libata-core.c	2004-02-14 18:51:14.000000000 +0000
+++ linuxppc-2.5-benh/drivers/scsi/libata-core.c	2004-02-16 07:06:29.000000000 +0000
@@ -39,6 +39,7 @@
 #include "hosts.h"
 #include <linux/libata.h>
 #include <asm/io.h>
+#include <linux/ide.h>
 #include <asm/semaphore.h>
 
 #include "libata.h"
@@ -1927,12 +1927,17 @@ static void ata_pio_sector(struct ata_po
 		status);
 
 	/* do the actual data transfer */
-	/* FIXME: mmio-ize */
-	if (qc->flags & ATA_QCFLAG_WRITE)
-		outsl(ap->ioaddr.data_addr, buf, ATA_SECT_DWORDS);
-	else
-		insl(ap->ioaddr.data_addr, buf, ATA_SECT_DWORDS);
-
+	if (ap->flags & ATA_FLAG_MMIO) {
+		if (qc->flags & ATA_QCFLAG_WRITE)
+			__ide_mm_outsl(ap->ioaddr.data_addr, buf, ATA_SECT_DWORDS);
+		else
+			__ide_mm_insl(ap->ioaddr.data_addr, buf, ATA_SECT_DWORDS);
+	} else {
+		if (qc->flags & ATA_QCFLAG_WRITE)
+			outsl(ap->ioaddr.data_addr, buf, ATA_SECT_DWORDS);
+		else
+			insl(ap->ioaddr.data_addr, buf, ATA_SECT_DWORDS);
+	}
 	kunmap(sg[qc->cursg].page);
 }
 
