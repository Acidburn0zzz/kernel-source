From: Jens Axboe <axboe@suse.de>
Subject: DM doesn't need io bounced
Patch-mainline: 2.6.15-git8
References: 90366

If the lower level driver(s) cannot accept high memory buffers, the bouncing
will take place there. If they can, we don't want to incur a bouncing
penalty for dm itself.

Acked-by: 
Signed-off-by: 

--- linux-2.6.14/drivers/md/dm.c~	2005-12-19 10:40:01.000000000 +0100
+++ linux-2.6.14/drivers/md/dm.c	2005-12-19 10:40:13.000000000 +0100
@@ -767,6 +767,7 @@
 	md->queue->backing_dev_info.congested_fn = dm_any_congested;
 	md->queue->backing_dev_info.congested_data = md;
 	blk_queue_make_request(md->queue, dm_request);
+	blk_queue_bounce_limit(md->queue, BLK_BOUNCE_ANY);
 	md->queue->unplug_fn = dm_unplug_all;
 	md->queue->issue_flush_fn = dm_flush_all;
 
