---
 sound/pci/echoaudio/echoaudio_dsp.c |    4 ++--
 sound/pci/echoaudio/echoaudio_dsp.h |   15 +++++++--------
 2 files changed, 9 insertions(+), 10 deletions(-)

--- a/sound/pci/echoaudio/echoaudio_dsp.c	2007-10-31 17:43:10.000000000 -0400
+++ b/sound/pci/echoaudio/echoaudio_dsp.c	2007-10-31 17:45:07.000000000 -0400
@@ -43,11 +43,11 @@ static int wait_handshake(struct echoaud
 {
 	int i;
 
-	/* Wait up to 10ms for the handshake from the DSP */
+	/* Wait up to 20ms for the handshake from the DSP */
 	for (i = 0; i < HANDSHAKE_TIMEOUT; i++) {
 		/* Look for the handshake value */
+		barrier();
 		if (chip->comm_page->handshake) {
-			/*if (i)  DE_ACT(("Handshake time: %d\n", i));*/
 			return 0;
 		}
 		udelay(1);
--- a/sound/pci/echoaudio/echoaudio_dsp.h	2007-10-31 17:43:10.000000000 -0400
+++ b/sound/pci/echoaudio/echoaudio_dsp.h	2007-10-31 17:45:07.000000000 -0400
@@ -642,18 +642,18 @@ struct comm_page {		/*				Base	Length*/
 	u32 flags;		/* See Appendix A below		0x004	4 */
 	u32 unused;		/* Unused entry			0x008	4 */
 	u32 sample_rate;	/* Card sample rate in Hz	0x00c	4 */
-	volatile u32 handshake;	/* DSP command handshake	0x010	4 */
+	u32 handshake;		/* DSP command handshake	0x010	4 */
 	u32 cmd_start;		/* Chs. to start mask		0x014	4 */
 	u32 cmd_stop;		/* Chs. to stop mask		0x018	4 */
 	u32 cmd_reset;		/* Chs. to reset mask		0x01c	4 */
 	u16 audio_format[DSP_MAXPIPES];	/* Chs. audio format	0x020	32*2 */
 	struct sg_entry sglist_addr[DSP_MAXPIPES];
 				/* Chs. Physical sglist addrs	0x060	32*8 */
-	volatile u32 position[DSP_MAXPIPES];
+	u32 position[DSP_MAXPIPES];
 				/* Positions for ea. ch.	0x160	32*4 */
-	volatile s8 vu_meter[DSP_MAXPIPES];
+	s8 vu_meter[DSP_MAXPIPES];
 				/* VU meters			0x1e0	32*1 */
-	volatile s8 peak_meter[DSP_MAXPIPES];
+	s8 peak_meter[DSP_MAXPIPES];
 				/* Peak meters			0x200	32*1 */
 	s8 line_out_level[DSP_MAXAUDIOOUTPUTS];
 				/* Output gain			0x220	16*1 */
@@ -665,7 +665,7 @@ struct comm_page {		/*				Base	Length*/
 			/* Gina/Darla play filters - obsolete	0x3c0	168*4 */
 	u32 rec_coeff[MAX_REC_TAPS];
 			/* Gina/Darla record filters - obsolete	0x660	192*4 */
-	volatile u16 midi_input[MIDI_IN_BUFFER_SIZE];
+	u16 midi_input[MIDI_IN_BUFFER_SIZE];
 			/* MIDI input data transfer buffer	0x960	256*2 */
 	u8 gd_clock_state;	/* Chg Gina/Darla clock state	0xb60	1 */
 	u8 gd_spdif_status;	/* Chg. Gina/Darla S/PDIF state	0xb61	1 */
@@ -674,11 +674,10 @@ struct comm_page {		/*				Base	Length*/
 	u32 nominal_level_mask;	/* -10 level enable mask	0xb64	4 */
 	u16 input_clock;	/* Chg. Input clock state	0xb68	2 */
 	u16 output_clock;	/* Chg. Output clock state	0xb6a	2 */
-	volatile u32 status_clocks;
-				/* Current Input clock state	0xb6c	4 */
+	u32 status_clocks;	/* Current Input clock state	0xb6c	4 */
 	u32 ext_box_status;	/* External box status		0xb70	4 */
 	u32 cmd_add_buffer;	/* Pipes to add (obsolete)	0xb74	4 */
-	volatile u32 midi_out_free_count;
+	u32 midi_out_free_count;
 			/* # of bytes free in MIDI output FIFO	0xb78	4 */
 	u32 unused2;		/* Cyclic pipes			0xb7c	4 */
 	u32 control_register;
