From: Dave Jones <davej@redhat.com>
Subject: [ALSA] fix usbmixer double kfree
Patch-mainline: 2.6.16-git
References: 

[ALSA] fix usbmixer double kfree

snd_ctl_add() kfree's the kcontrol already if we fail there,
so this driver is currently doing a double kfree.

Coverity bug #959

Signed-off-by: Dave Jones <davej@redhat.com>
Signed-off-by: Takashi Iwai <tiwai@suse.de>

---
commit 0af3a33c197eb210d9fd12fc41b25316e7b694b1
tree 52b1eb0319e2aa228179e96969b7c8ab998bc1a6
parent d4a1bdca5525343d337d6b935db8d301983afc04
author Dave Jones <davej@redhat.com> Mon, 06 Mar 2006 14:26:10 +0100
committer Takashi Iwai <tiwai@suse.de> Mon, 06 Mar 2006 15:20:47 +0100

 sound/usb/usbmixer.c |    1 -
 1 files changed, 0 insertions(+), 1 deletions(-)

diff --git a/sound/usb/usbmixer.c b/sound/usb/usbmixer.c
index 678dac2..0bfea72 100644
--- a/sound/usb/usbmixer.c
+++ b/sound/usb/usbmixer.c
@@ -434,7 +434,6 @@ static int add_control_to_empty(struct m
 		kctl->id.index++;
 	if ((err = snd_ctl_add(state->chip->card, kctl)) < 0) {
 		snd_printd(KERN_ERR "cannot add control (err = %d)\n", err);
-		snd_ctl_free_one(kctl);
 		return err;
 	}
 	cval->elem_id = &kctl->id;
