From: Dave Jones <davej@redhat.com>
Subject: [ALSA] sound/isa/sb/sb_mixer.c double kfree
Patch-mainline: 2.6.16-git
References: 


snd_ctl_add() already does the free on error.

Coverity bug #957

Signed-off-by: Dave Jones <davej@redhat.com>
Signed-off-by: Takashi Iwai <tiwai@suse.de>

---
commit 118ad9fd82e39af9f874857398f61a5470a82a94
tree 58ec523f2ded4d62e956a938eb471ee2e953b9d6
parent 9357c31fda39b5103cdd11450baaf752a73ad70a
author Dave Jones <davej@redhat.com> Mon, 06 Mar 2006 14:28:34 +0100
committer Takashi Iwai <tiwai@suse.de> Mon, 06 Mar 2006 15:20:48 +0100

 sound/isa/sb/sb_mixer.c |    4 +---
 1 files changed, 1 insertions(+), 3 deletions(-)

diff --git a/sound/isa/sb/sb_mixer.c b/sound/isa/sb/sb_mixer.c
index 1a6ee34..490b1ca 100644
--- a/sound/isa/sb/sb_mixer.c
+++ b/sound/isa/sb/sb_mixer.c
@@ -453,10 +453,8 @@ int snd_sbmixer_add_ctl(struct snd_sb *c
 	strlcpy(ctl->id.name, name, sizeof(ctl->id.name));
 	ctl->id.index = index;
 	ctl->private_value = value;
-	if ((err = snd_ctl_add(chip->card, ctl)) < 0) {
-		snd_ctl_free_one(ctl);
+	if ((err = snd_ctl_add(chip->card, ctl)) < 0)
 		return err;
-	}
 	return 0;
 }
 
