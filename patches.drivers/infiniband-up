diff -u linux-2.6.3/drivers/infiniband/hw/mellanox-hca/mosal/mosal_iobuf.c-o linux-2.6.3/drivers/infiniband/hw/mellanox-hca/mosal/mosal_iobuf.c
--- linux-2.6.3/drivers/infiniband/hw/mellanox-hca/mosal/mosal_iobuf.c-o	2004-02-28 20:29:12.000000000 +0100
+++ linux-2.6.3/drivers/infiniband/hw/mellanox-hca/mosal/mosal_iobuf.c	2004-02-28 21:12:38.331040908 +0100
@@ -1174,7 +1174,6 @@
   }
   up_read(&current->mm->mmap_sem);
 #else
-#ifdef MT_FLUSH_TLB_TAKES_VMA
   struct vm_area_struct *vma;
   MT_virt_addr_t va = iobuf->va;
 
@@ -1184,9 +1183,6 @@
     flush_tlb_range(vma, iobuf->va, iobuf->va+iobuf->size);
   }
   up_read(&current->mm->mmap_sem);
-#else
-  flush_tlb_range(current->mm, iobuf->va, iobuf->va+iobuf->size);
-#endif
 #endif
 }
 
