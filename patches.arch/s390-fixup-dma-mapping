From: Hannes Reinecke <hare@suse.de>
Subject: dma_map_sg() undefined on S/390

Everyone and their dog seems to assume that all machines require
DMA. Which is not the case. So define missing functions on S/390.

Signed-off-by: Hannes Reinecke <hare@suse.de>

diff --git a/include/asm-generic/dma-mapping-broken.h b/include/asm-generic/dma-mapping-broken.h
index 29413d3..42cf7fd 100644
--- a/include/asm-generic/dma-mapping-broken.h
+++ b/include/asm-generic/dma-mapping-broken.h
@@ -18,6 +18,22 @@ dma_free_coherent(struct device *dev, size_t size, void *cpu_addr,
 	BUG();
 }
 
+static inline int
+dma_map_sg(struct device *dev, struct scatterlist *sg, int nents,
+	   enum dma_data_direction direction)
+{
+	BUG();
+
+	return 0;
+}
+
+static inline void
+dma_unmap_sg(struct device *dev, struct scatterlist *sg, int nhwentries,
+	     enum dma_data_direction direction)
+{
+	BUG();
+}
+
 #define dma_alloc_noncoherent(d, s, h, f) dma_alloc_coherent(d, s, h, f)
 #define dma_free_noncoherent(d, s, v, h) dma_free_coherent(d, s, v, h)
 
diff --git a/include/asm-s390/dma-mapping.h b/include/asm-s390/dma-mapping.h
index 3f8c12f..09bb7b0 100644
--- a/include/asm-s390/dma-mapping.h
+++ b/include/asm-s390/dma-mapping.h
@@ -9,4 +9,6 @@
 #ifndef _ASM_DMA_MAPPING_H
 #define _ASM_DMA_MAPPING_H
 
+#include <asm-generic/dma-mapping-broken.h>
+
 #endif /* _ASM_DMA_MAPPING_H */
