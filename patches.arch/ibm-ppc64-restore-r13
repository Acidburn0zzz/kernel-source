ChangeSet
  1.1762 04/04/13 09:26:35 akpm@osdl.org[torvalds] +1 -0
  [PATCH] ppc64: restore r13 in an unrecoverable exception
  
  From: Anton Blanchard <anton@samba.org>
  
  We have to restore r13 when entering unrecoverable_exception.

  arch/ppc64/kernel/entry.S
    1.37 04/04/13 08:46:52 akpm@osdl.org[torvalds] +1 -0
    ppc64: restore r13 in an unrecoverable exception

diff -Nru a/arch/ppc64/kernel/entry.S b/arch/ppc64/kernel/entry.S
--- a/arch/ppc64/kernel/entry.S	Wed Apr 14 07:11:57 2004
+++ b/arch/ppc64/kernel/entry.S	Wed Apr 14 07:11:57 2004
@@ -469,6 +469,7 @@
 	b	.ret_from_except
 
 unrecov_restore:
+	mfspr   r13,SPRG3
 	addi	r3,r1,STACK_FRAME_OVERHEAD
 	bl	.unrecoverable_exception
 	b	unrecov_restore
.........................................................................
# vim: syntax=diff

