--- linux-2.6.4/arch/x86_64/kernel/pci-gart.c~	2004-03-29 14:55:35.859668599 +0200
+++ linux-2.6.4/arch/x86_64/kernel/pci-gart.c	2004-03-29 14:56:48.638778154 +0200
@@ -194,7 +194,8 @@
 
 	/* Kludge to make it bug-to-bug compatible with i386. i386
 	   uses the normal dma_mask for alloc_consistent. */
-	dma_mask &= hwdev->dma_mask;
+	if (hwdev)
+		dma_mask &= hwdev->dma_mask;
 
  again:
 	memory = (void *)__get_free_pages(gfp, get_order(size));
