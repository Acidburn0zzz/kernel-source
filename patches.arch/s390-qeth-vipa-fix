From: Ursula Braun <braunu@de.ibm.com>
Subject: qeth: qethconf not adding IPv4 addresses
References: #160481 - LTC22637
Patch-Mainline: yes

Symptom:     /var/log/messages \"kernel: qeth: Invalid IP address format!\"
Problem:     Incorrect syntax checking of IPv4 addresses.
Solution:    Change result checking of sscanf invocation.
Problem-ID:  22637
Archs:       s390-31, s390-64
Branches:    June 2003,    kernel 2.4.21: no
             April 2004,   kernel 2.6.5 : yes
             October 2005, kernel 2.6.15: yes

Signed-off-by: Hannes Reinecke <hare@suse.de>

Index: linux-2.5/drivers/s390/net/qeth.h
===================================================================
RCS file: /home/cvs/linux-2.5/drivers/s390/net/qeth.h,v
retrieving revision 1.155
diff -a -u -r1.155 qeth.h
--- linux-2.5/drivers/s390/net/qeth.h	1 Feb 2006 15:26:51 -0000	1.155
+++ linux-2.5/drivers/s390/net/qeth.h	23 Mar 2006 16:33:45 -0000
@@ -1099,7 +1099,7 @@
 
 	rc = sscanf(buf, "%d.%d.%d.%d%n", 
 		    &in[0], &in[1], &in[2], &in[3], &count);
-	if (rc != 4  || count) 
+	if (rc != 4  || count<=0)
 		return -EINVAL;
 	for (count = 0; count < 4; count++) {
 		if (in[count] > 255)
