Subject: hide EEH and NUMA support for crashdump kernel builds
From: olh@suse.de
References: 175754 - LTC23902

---
 arch/powerpc/Kconfig                   |    2 +-
 arch/powerpc/platforms/pseries/Kconfig |    2 +-
 2 files changed, 2 insertions(+), 2 deletions(-)

Index: linux-2.6.16/arch/powerpc/platforms/pseries/Kconfig
===================================================================
--- linux-2.6.16.orig/arch/powerpc/platforms/pseries/Kconfig
+++ linux-2.6.16/arch/powerpc/platforms/pseries/Kconfig
@@ -11,7 +11,7 @@ config PPC_SPLPAR
 
 config EEH
 	bool "PCI Extended Error Handling (EEH)" if EMBEDDED
-	depends on PPC_PSERIES
+	depends on PPC_PSERIES && !CRASH_DUMP
 	default y if !EMBEDDED
 
 config SCANLOG
Index: linux-2.6.16/arch/powerpc/Kconfig
===================================================================
--- linux-2.6.16.orig/arch/powerpc/Kconfig
+++ linux-2.6.16/arch/powerpc/Kconfig
@@ -615,7 +615,7 @@ source "arch/powerpc/platforms/pseries/K
 
 config NUMA
 	bool "NUMA support"
-	depends on PPC64
+	depends on PPC64 && !CRASH_DUMP
 	default y if SMP && PPC_PSERIES
 
 config ARCH_SELECT_MEMORY_MODEL
