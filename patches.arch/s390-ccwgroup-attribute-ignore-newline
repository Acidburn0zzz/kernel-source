From: Hannes Reinecke <hare@suse.de>
Subject: udev cannot activate ccwgroup devices

udev writes sysfs attributes without a trailing newline. This is
(wrongly) rejected by s390 drivers.

Signed-off-by: Hannes Reinecke <hare@suse.de>

---
 drivers/s390/net/cu3088.c   |    7 +++++--
 drivers/s390/net/qeth_sys.c |    7 +++++--
 2 files changed, 10 insertions(+), 4 deletions(-)

--- a/drivers/s390/net/cu3088.c
+++ b/drivers/s390/net/cu3088.c
@@ -76,8 +76,11 @@ group_write(struct device_driver *drv, c
 		static const char delim[] = {',', '\n'};
 		int len;
 
-		if (!(end = strchr(start, delim[i])))
-			return -EINVAL;
+		if (!(end = strchr(start, delim[i]))) {
+			if (i != 1)
+				return -EINVAL;
+			end = buf + count;
+		}
 		len = min_t(ptrdiff_t, BUS_ID_SIZE, end - start + 1);
 		strlcpy (bus_ids[i], start, len);
 		argv[i] = bus_ids[i];
--- a/drivers/s390/net/qeth_sys.c
+++ b/drivers/s390/net/qeth_sys.c
@@ -1788,8 +1788,11 @@ qeth_driver_group_store(struct device_dr
 		static const char delim[] = { ',', ',', '\n' };
 		int len;
 
-		if (!(end = strchr(start, delim[i])))
-			return -EINVAL;
+		if (!(end = strchr(start, delim[i]))) {
+			if (i != 2)
+				return -EINVAL;
+			end = buf + count;
+		}
 		len = min_t(ptrdiff_t, BUS_ID_SIZE, end - start);
 		strncpy(bus_ids[i], start, len);
 		bus_ids[i][len] = '\0';
