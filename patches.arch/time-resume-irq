diff -u linux/arch/i386/kernel/time.c-o linux/arch/i386/kernel/time.c
--- linux/arch/i386/kernel/time.c-o	2004-09-20 19:59:18.000000000 +0200
+++ linux/arch/i386/kernel/time.c	2004-09-22 15:23:36.000000000 +0200
@@ -333,11 +333,12 @@
 
 static int time_resume(struct sys_device *dev)
 {
+	unsigned long flags;
 	unsigned long sec = get_cmos_time() + clock_cmos_diff;
-	write_seqlock_irq(&xtime_lock);
+	write_seqlock_irqsave(&xtime_lock,flags);
 	xtime.tv_sec = sec;
 	xtime.tv_nsec = 0;
-	write_sequnlock_irq(&xtime_lock);
+	write_sequnlock_irqrestore(&xtime_lock,flags);
 	return 0;
 }
 
diff -u linux/arch/x86_64/kernel/time.c-o linux/arch/x86_64/kernel/time.c
--- linux/arch/x86_64/kernel/time.c-o	2004-09-20 19:58:40.000000000 +0200
+++ linux/arch/x86_64/kernel/time.c	2004-09-22 15:23:18.000000000 +0200
@@ -873,11 +873,12 @@
 
 static int time_resume(struct sys_device *dev)
 {
+	unsigned long flags;
 	unsigned long sec = get_cmos_time() + clock_cmos_diff;
-	write_seqlock_irq(&xtime_lock);
+	write_seqlock_irqsave(&xtime_lock,flags);
 	xtime.tv_sec = sec;
 	xtime.tv_nsec = 0;
-	write_sequnlock_irq(&xtime_lock);
+	write_sequnlock_irqrestore(&xtime_lock,flags);
 	return 0;
 }
 
