ChangeSet
  1.1713.17.28 04/04/12 12:44:51 akpm@osdl.org[torvalds] +2 -0
  [PATCH] ppc64: Make rtasd dump KERN_DEBUG
  
  From: Jake Moilanen <moilanen@austin.ibm.com>
  
  Change the loglevel of an error log printed so it
  does not goto the console.  Since error logs can
  be upto 2k in size, it can spam the console.

  include/asm-ppc64/rtas.h
    1.14 04/04/12 10:54:04 akpm@osdl.org[torvalds] +1 -1
    ppc64: Make rtasd dump KERN_DEBUG

  arch/ppc64/kernel/rtasd.c
    1.19 04/04/12 10:54:04 akpm@osdl.org[torvalds] +4 -4
    ppc64: Make rtasd dump KERN_DEBUG

diff -Nru a/arch/ppc64/kernel/rtasd.c b/arch/ppc64/kernel/rtasd.c
--- a/arch/ppc64/kernel/rtasd.c	Tue Apr 13 07:24:54 2004
+++ b/arch/ppc64/kernel/rtasd.c	Tue Apr 13 07:24:54 2004
@@ -78,7 +78,7 @@
 	char buffer[64];
 	char * str = "RTAS event";
 
-	printk(RTAS_ERR "%d -------- %s begin --------\n", error_log_cnt, str);
+	printk(RTAS_DEBUG "%d -------- %s begin --------\n", error_log_cnt, str);
 
 	/*
 	 * Print perline bytes on each line, each line will start
@@ -99,12 +99,12 @@
 		n += sprintf(buffer+n, "%02x", (unsigned char)buf[i]);
 
 		if (j == (perline-1))
-			printk(KERN_ERR "%s\n", buffer);
+			printk(KERN_DEBUG "%s\n", buffer);
 	}
 	if ((i % perline) != 0)
-		printk(KERN_ERR "%s\n", buffer);
+		printk(KERN_DEBUG "%s\n", buffer);
 
-	printk(RTAS_ERR "%d -------- %s end ----------\n", error_log_cnt, str);
+	printk(RTAS_DEBUG "%d -------- %s end ----------\n", error_log_cnt, str);
 }
 
 static int log_rtas_len(char * buf)
diff -Nru a/include/asm-ppc64/rtas.h b/include/asm-ppc64/rtas.h
--- a/include/asm-ppc64/rtas.h	Tue Apr 13 07:24:54 2004
+++ b/include/asm-ppc64/rtas.h	Tue Apr 13 07:24:54 2004
@@ -198,7 +198,7 @@
 /* All the types and not flags */
 #define ERR_TYPE_MASK	(ERR_TYPE_RTAS_LOG | ERR_TYPE_KERNEL_PANIC)
 
-#define RTAS_ERR KERN_ERR "RTAS: "
+#define RTAS_DEBUG KERN_DEBUG "RTAS: "
  
 #define RTAS_ERROR_LOG_MAX 2048
  
.........................................................................
# vim: syntax=diff

