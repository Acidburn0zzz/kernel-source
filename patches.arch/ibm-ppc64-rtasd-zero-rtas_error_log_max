ChangeSet 1.1471.1.2 2004/02/27 09:42:48 moilanen@zippy.ltc.austin.ibm.com
  Fix for FW having a 0 len rtas-error-log-max.
arch/ppc64/kernel/rtasd.c 1.22 2004/02/27 09:42:39 moilanen@zippy.ltc.austin.ibm.com
  Fix for FW having a 0 len rtas-error-log-max.
diff -purN linux-2.5/arch/ppc64/kernel/rtasd.c linuxppc64-2.5/arch/ppc64/kernel/rtasd.c
--- linux-2.5/arch/ppc64/kernel/rtasd.c	2004-03-16 11:30:38.000000000 +0000
+++ linuxppc64-2.5/arch/ppc64/kernel/rtasd.c	2004-03-17 00:46:46.000000000 +0000
@@ -119,10 +119,11 @@ static int log_rtas_len(char * buf)
 
 		/* extended header */
 		len += err->extended_log_length;
-
-		if (len > RTAS_ERROR_LOG_MAX)
-			len = RTAS_ERROR_LOG_MAX;
 	}
+
+	if (len > rtas_error_log_max)
+		len = rtas_error_log_max;
+
 	return len;
 }
 
