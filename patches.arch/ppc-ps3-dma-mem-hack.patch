patches/ps3-wip/ps3stor+snd-mem-hack.diff
---
 arch/powerpc/platforms/ps3/mm.c |   16 ++++++++++++++++
 1 file changed, 16 insertions(+)

Index: b/arch/powerpc/platforms/ps3/mm.c
===================================================================
--- a/arch/powerpc/platforms/ps3/mm.c
+++ b/arch/powerpc/platforms/ps3/mm.c
@@ -128,6 +128,16 @@ static void _debug_dump_map(const struct
 
 static struct map map;
 
+// FIXME Temporary solution for the storage and sound drivers
+unsigned long ps3_mem_total;
+EXPORT_SYMBOL_GPL(ps3_mem_total);
+unsigned long ps3_rm_limit;
+EXPORT_SYMBOL_GPL(ps3_rm_limit);
+unsigned long ps3_2nd_mem_base;
+EXPORT_SYMBOL_GPL(ps3_2nd_mem_base);
+unsigned long ps3_2nd_mem_size;
+EXPORT_SYMBOL_GPL(ps3_2nd_mem_size);
+
 /**
  * ps3_mm_phys_to_lpar - translate a linux physical address to lpar address
  * @phys_addr: linux physical address
@@ -816,6 +826,12 @@ void __init ps3_mm_init(void)
 	/* arrange to do this in ps3_mm_add_memory */
 	ps3_mm_region_create(&map.r1, map.total - map.rm.size);
 
+	// FIXME Temporary solution for the storage and sound drivers
+	ps3_mem_total = map.rm.size + map.r1.size;
+	ps3_rm_limit = map.rm.size;
+	ps3_2nd_mem_base = map.r1.base;
+	ps3_2nd_mem_size = map.r1.size;
+
 	DBG(" <- %s:%d\n", __func__, __LINE__);
 }
 
