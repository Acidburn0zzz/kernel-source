From: Jeff Mahoney <jeffm@suse.com>
Subject: [PATCH] thinkpad_acpi: Fix oops with incompatible backlight interface

 Mainline commit 2dba1b5d87e08a294da5cdfa4d32908000e9b085 (trenn's patch
 thinkpad_fingers_off_backlight_igd.patch added new users of
 ibm_backlight_device.

 brightness_init() returns -errno on fatal errors and 1 if the interface
 is incompatible. This leaves ibm_backlight_device == NULL, which causes
 an oops in hotkey_notify().

 This patch adds a check for ibm_backlight_device.

Signed-off-by: Jeff Mahoney <jeffm@suse.com>
---
 drivers/misc/thinkpad_acpi.c |    2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

--- a/drivers/misc/thinkpad_acpi.c
+++ b/drivers/misc/thinkpad_acpi.c
@@ -2404,7 +2404,7 @@ static void hotkey_notify(struct ibm_str
 		case 1:
 			/* 0x1000-0x1FFF: key presses */
 			scancode = hkey & 0xfff;
-			if (tp_features.bright_igdmode) {
+			if (tp_features.bright_igdmode && ibm_backlight_device) {
 				/* ToDo:
 				 * Is there an already defined key?
 				 */
