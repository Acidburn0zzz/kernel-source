Date: Thu, 29 Apr 2004 19:40:22 +1000
From: Anton Blanchard <anton@samba.org>
To: olh@suse.de
Subject: increase max order


Hi,

This gave us a big boost on specSFS (NFS benchmark). We have a limit on
the hashes so bumping max order shouldnt increase them automatically.
You need to do it via a command line option. This means it shouldnt
hurt most people who dont care about huge filesystems.

Anton

===== arch/ppc64/Kconfig 1.62 vs edited =====
--- 1.62/arch/ppc64/Kconfig	Wed Apr 14 03:25:57 2004
+++ edited/arch/ppc64/Kconfig	Thu Apr 29 19:38:04 2004
@@ -40,12 +40,13 @@
 	bool
 	default y
 
-# We optimistically allocate largepages from the VM, so make the limit
-# large enough (16MB). This badly named config option is actually
-# max order + 1
+# This badly named config option is actually max order + 1. This limits
+# the largest allocation we can do with get_free_pages. In order to make
+# the dentry and inode hashes big enough on machines with massive filesystems
+# we keep this quite high (1GB)
 config FORCE_MAX_ZONEORDER
 	int
-	default "13"
+	default "19"
 
 source "init/Kconfig"
 
