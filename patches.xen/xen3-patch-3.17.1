From: Jiri Slaby <jslaby@suse.cz>
Subject: Linux 3.17.1
Patch-mainline: 3.17.1

Signed-off-by: Jiri Slaby <jslaby@suse.cz>
Automatically created from "patches.kernel.org/patch-3.17.1" by xen-port-patches.py

--- head.orig/arch/x86/include/asm/irq_work.h	2014-10-17 13:49:30.000000000 +0200
+++ head/arch/x86/include/asm/irq_work.h	2014-10-17 14:18:08.000000000 +0200
@@ -5,7 +5,13 @@
 
 static inline bool arch_irq_work_has_interrupt(void)
 {
+#ifndef CONFIG_XEN
 	return cpu_has_apic;
+#elif defined(CONFIG_SMP)
+	return 1;
+#else
+	return 0;
+#endif
 }
 
 #endif /* _ASM_IRQ_WORK_H */
