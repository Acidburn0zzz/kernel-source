From: Greg Kroah-Hartman <gregkh@suse.de>
Subject: Linux 2.6.27.9

Upstream 2.6.27.9 release from kernel.org

Signed-off-by: Greg Kroah-Hartman <gregkh@suse.de>

Automatically created from "patches.kernel.org/patch-2.6.27.8-9" by xen-port-patches.py

--- head-2009-01-06.orig/arch/x86/mm/init_64-xen.c	2009-01-07 10:49:18.000000000 +0100
+++ head-2009-01-06/arch/x86/mm/init_64-xen.c	2009-01-07 10:53:11.000000000 +0100
@@ -1026,12 +1026,12 @@ int arch_add_memory(int nid, u64 start, 
 	unsigned long nr_pages = size >> PAGE_SHIFT;
 	int ret;
 
-	last_mapped_pfn = init_memory_mapping(start, start + size-1);
+	last_mapped_pfn = init_memory_mapping(start, start + size);
 	if (last_mapped_pfn > max_pfn_mapped)
 		max_pfn_mapped = last_mapped_pfn;
 
 	ret = __add_pages(zone, start_pfn, nr_pages);
-	WARN_ON(1);
+	WARN_ON_ONCE(ret);
 
 	return ret;
 }
