# HG changeset 8843 patch
# User cl349@firebug.cl.cam.ac.uk
# Node ID 765b0657264d6c9e4843c30875154e1269a55d4e
# Parent  fd3f1e38fdcf9efd444d63e535d943b3f996d1a3
From: Christian Limpach <Christian.Limpach@cl.cam.ac.uk>
Subject: Cleanup x86/x86_64 apic.c files.

Signed-off-by: Christian Limpach <Christian.Limpach@cl.cam.ac.uk>

Stripped stylistic only changes.

Acked-by: Jan Beulich <jbeulich@novell.com>

Index: head-2006-03-02/arch/i386/kernel/apic-xen.c
===================================================================
--- head-2006-03-02.orig/arch/i386/kernel/apic-xen.c	2006-03-02 13:27:49.000000000 +0100
+++ head-2006-03-02/arch/i386/kernel/apic-xen.c	2006-02-16 17:07:08.000000000 +0100
@@ -122,12 +122,12 @@ void smp_send_timer_broadcast_ipi(struct
 #endif
 	}
 }
+#endif
 
 int setup_profiling_timer(unsigned int multiplier)
 {
 	return -EINVAL;
 }
-#endif
 
 /*
  * This initializes the IO-APIC and APIC hardware if this is
Index: head-2006-03-02/arch/x86_64/kernel/apic-xen.c
===================================================================
--- head-2006-03-02.orig/arch/x86_64/kernel/apic-xen.c	2006-03-02 13:27:49.000000000 +0100
+++ head-2006-03-02/arch/x86_64/kernel/apic-xen.c	2006-02-16 17:07:08.000000000 +0100
@@ -36,9 +36,6 @@
 #include <asm/hpet.h>
 #include <asm/idle.h>
 
-/*
- * Debug level
- */
 int apic_verbosity;
 int disable_apic;
 
@@ -62,6 +59,11 @@ void ack_bad_irq(unsigned int irq)
 		ack_APIC_irq();
 }
 
+int setup_profiling_timer(unsigned int multiplier)
+{
+	return -EINVAL;
+}
+
 void smp_local_timer_interrupt(struct pt_regs *regs)
 {
 	profile_tick(CPU_PROFILING, regs);
@@ -179,10 +181,6 @@ asmlinkage void smp_error_interrupt(void
 	irq_exit();
 }
 
-int get_physical_broadcast(void)
-{
-        return 0xff;
-}
 
 #ifdef CONFIG_XEN
 void switch_APIC_timer_to_ipi(void *cpumask) { }
Index: head-2006-03-02/drivers/xen/core/smpboot.c
===================================================================
--- head-2006-03-02.orig/drivers/xen/core/smpboot.c	2006-03-02 13:29:27.000000000 +0100
+++ head-2006-03-02/drivers/xen/core/smpboot.c	2006-03-02 13:29:38.000000000 +0100
@@ -447,11 +447,12 @@ void __init smp_cpus_done(unsigned int m
 {
 }
 
+#ifndef CONFIG_X86_LOCAL_APIC
 int setup_profiling_timer(unsigned int multiplier)
 {
-	/* Dummy function. */
-	return 0;
+	return -EINVAL;
 }
+#endif
 
 /*
  * Local variables:
