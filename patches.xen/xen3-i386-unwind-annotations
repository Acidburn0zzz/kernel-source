From: jbeulich@novell.com
Subject: fix unwind annotations
Patch-mainline: 2.6.37

Automatically created from "patches.arch/i386-unwind-annotations" by xen-port-patches.py

--- head-2010-08-24.orig/arch/x86/kernel/entry_32-xen.S	2010-08-25 14:29:15.000000000 +0200
+++ head-2010-08-24/arch/x86/kernel/entry_32-xen.S	2010-08-25 14:29:23.000000000 +0200
@@ -819,14 +819,19 @@ ptregs_##name: \
 #define PTREGSCALL3(name) \
 	ALIGN; \
 ptregs_##name: \
+	CFI_STARTPROC; \
 	leal 4(%esp),%eax; \
 	pushl %eax; \
+	CFI_ADJUST_CFA_OFFSET 4; \
 	movl PT_EDX(%eax),%ecx; \
 	movl PT_ECX(%eax),%edx; \
 	movl PT_EBX(%eax),%eax; \
 	call sys_##name; \
 	addl $4,%esp; \
-	ret
+	CFI_ADJUST_CFA_OFFSET -4; \
+	ret; \
+	CFI_ENDPROC; \
+ENDPROC(ptregs_##name)
 
 PTREGSCALL1(iopl)
 PTREGSCALL0(fork)
@@ -841,15 +846,21 @@ PTREGSCALL1(vm86old)
 /* Clone is an oddball.  The 4th arg is in %edi */
 	ALIGN;
 ptregs_clone:
+	CFI_STARTPROC
 	leal 4(%esp),%eax
 	pushl %eax
+	CFI_ADJUST_CFA_OFFSET 4
 	pushl PT_EDI(%eax)
+	CFI_ADJUST_CFA_OFFSET 4
 	movl PT_EDX(%eax),%ecx
 	movl PT_ECX(%eax),%edx
 	movl PT_EBX(%eax),%eax
 	call sys_clone
 	addl $8,%esp
+	CFI_ADJUST_CFA_OFFSET -8
 	ret
+	CFI_ENDPROC
+ENDPROC(ptregs_clone)
 
 #ifndef CONFIG_XEN
 .macro FIXUP_ESPFIX_STACK
