From: jbeulich@novell.com
Subject: print at least a message if MSI-X restore failed
Patch-mainline: obsolete

Index: head-2008-08-18/drivers/pci/msi-xen.c
===================================================================
--- head-2008-08-18.orig/drivers/pci/msi-xen.c	2008-08-18 14:06:26.000000000 +0200
+++ head-2008-08-18/drivers/pci/msi-xen.c	2008-08-19 09:53:08.000000000 +0200
@@ -310,8 +310,15 @@ static void __pci_restore_msix_state(str
 
 	spin_lock_irqsave(&msi_dev_entry->pirq_list_lock, flags);
 	list_for_each_entry_safe(pirq_entry, tmp,
-							 &msi_dev_entry->pirq_list_head, list)
-		msi_map_pirq_to_vector(dev, pirq_entry->pirq, pirq_entry->entry_nr, 0);
+				 &msi_dev_entry->pirq_list_head, list) {
+		int rc = msi_map_pirq_to_vector(dev, pirq_entry->pirq,
+						pirq_entry->entry_nr, 0);
+		if (rc < 0)
+			printk(KERN_WARNING
+			       "%s: re-mapping irq #%d (pirq%d) failed: %d\n",
+			       pci_name(dev), pirq_entry->entry_nr,
+			       pirq_entry->pirq, rc);
+	}
 	spin_unlock_irqrestore(&msi_dev_entry->pirq_list_lock, flags);
 
 	pci_intx_for_msi(dev, 0);
