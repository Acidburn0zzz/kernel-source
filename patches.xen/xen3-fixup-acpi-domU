Subject: Disable ACPI in unprivilidged xen domains
From: kraxel@suse.de

Index: linux-2.6.14/arch/i386/xen/kernel/setup.c
===================================================================
--- linux-2.6.14.orig/arch/i386/xen/kernel/setup.c	2005-12-07 13:30:20.000000000 +0100
+++ linux-2.6.14/arch/i386/xen/kernel/setup.c	2005-12-07 16:19:12.000000000 +0100
@@ -1805,15 +1805,12 @@ void __init setup_arch(char **cmdline_p)
 	op.u.set_iopl.iopl = 1;
 	HYPERVISOR_physdev_op(&op);
 
-#ifdef CONFIG_ACPI_BOOT
+#ifdef CONFIG_ACPI
 	if (!(xen_start_info->flags & SIF_INITDOMAIN)) {
 		printk(KERN_INFO "ACPI in unprivileged domain disabled\n");
 		acpi_disabled = 1;
 		acpi_ht = 0;
 	}
-#endif
-
-#ifdef CONFIG_ACPI
 	/*
 	 * Parse the ACPI tables for possible boot-time SMP configuration.
 	 */
