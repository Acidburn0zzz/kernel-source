From: jbeulich@novell.com
Subject: Allow xenbus_strstate() to be used from modules
Patch-mainline: obsolete

Also, properly const-ify it.

Index: head-2007-01-16/drivers/xen/xenbus/xenbus_client.c
===================================================================
--- head-2007-01-16.orig/drivers/xen/xenbus/xenbus_client.c	2007-01-17 10:10:12.000000000 +0100
+++ head-2007-01-16/drivers/xen/xenbus/xenbus_client.c	2007-01-29 16:13:36.000000000 +0100
@@ -42,9 +42,9 @@
 #define DPRINTK(fmt, args...) \
     pr_debug("xenbus_client (%s:%d) " fmt ".\n", __FUNCTION__, __LINE__, ##args)
 
-char *xenbus_strstate(enum xenbus_state state)
+const char *xenbus_strstate(enum xenbus_state state)
 {
-	static char *name[] = {
+	static const char *const name[] = {
 		[ XenbusStateUnknown      ] = "Unknown",
 		[ XenbusStateInitialising ] = "Initialising",
 		[ XenbusStateInitWait     ] = "InitWait",
@@ -55,6 +55,7 @@ char *xenbus_strstate(enum xenbus_state 
 	};
 	return (state < ARRAY_SIZE(name)) ? name[state] : "INVALID";
 }
+EXPORT_SYMBOL_GPL(xenbus_strstate);
 
 int xenbus_watch_path(struct xenbus_device *dev, const char *path,
 		      struct xenbus_watch *watch,
Index: head-2007-01-16/include/xen/xenbus.h
===================================================================
--- head-2007-01-16.orig/include/xen/xenbus.h	2007-01-17 10:09:52.000000000 +0100
+++ head-2007-01-16/include/xen/xenbus.h	2007-01-29 16:14:09.000000000 +0100
@@ -292,7 +292,7 @@ void xenbus_dev_fatal(struct xenbus_devi
 
 int __init xenbus_dev_init(void);
 
-char *xenbus_strstate(enum xenbus_state state);
+const char *xenbus_strstate(enum xenbus_state state);
 int xenbus_dev_is_online(struct xenbus_device *dev);
 int xenbus_frontend_closed(struct xenbus_device *dev);
 
