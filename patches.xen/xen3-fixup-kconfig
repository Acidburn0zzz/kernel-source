Subject: Fix xen configuration.
From: jbeulich@novell.com
Patch-mainline: obsolete

Index: head-2008-08-22/arch/x86/Kconfig
===================================================================
--- head-2008-08-22.orig/arch/x86/Kconfig	2008-08-22 14:52:38.000000000 +0200
+++ head-2008-08-22/arch/x86/Kconfig	2008-08-22 14:56:59.000000000 +0200
@@ -136,6 +136,7 @@ config HAVE_CPUMASK_OF_CPU_MAP
 config ARCH_HIBERNATION_POSSIBLE
 	def_bool y
 	depends on !SMP || !X86_VOYAGER
+	depends on !XEN
 
 config ARCH_SUSPEND_POSSIBLE
 	def_bool y
@@ -194,7 +195,7 @@ config X86_HT
 
 config X86_BIOS_REBOOT
 	bool
-	depends on !X86_VOYAGER
+	depends on !X86_VOYAGER && !XEN
 	default y
 
 config X86_TRAMPOLINE
Index: head-2008-08-22/arch/x86/Kconfig.debug
===================================================================
--- head-2008-08-22.orig/arch/x86/Kconfig.debug	2008-08-22 14:52:38.000000000 +0200
+++ head-2008-08-22/arch/x86/Kconfig.debug	2008-08-22 14:56:59.000000000 +0200
@@ -303,7 +303,7 @@ config OPTIMIZE_INLINING
 
 config KDB
 	bool "Built-in Kernel Debugger support"
-	depends on DEBUG_KERNEL
+	depends on DEBUG_KERNEL && !XEN
 	select KALLSYMS
 	select KALLSYMS_ALL
 	help
Index: head-2008-08-22/drivers/xen/Kconfig
===================================================================
--- head-2008-08-22.orig/drivers/xen/Kconfig	2008-08-22 14:52:38.000000000 +0200
+++ head-2008-08-22/drivers/xen/Kconfig	2008-08-22 14:56:59.000000000 +0200
@@ -21,6 +19,9 @@ config XEN_PRIVILEGED_GUEST
 
 config XEN_UNPRIVILEGED_GUEST
 	def_bool !XEN_PRIVILEGED_GUEST
+	select PM
+	select PM_SLEEP
+	select PM_SLEEP_SMP if SMP
 
 config XEN_PRIVCMD
 	def_bool y
