From: riel@redhat.com
Subject: Various bits to support 2.6.11-rc1

Some tidbits to make Xen (-unstable) compile with the latest
2.6 snapshot.  No need for you to duplicate the work I already
did.

Rediffed and 
Acked-by: garloff@suse.de
Signed-off-by: Rik van Riel <riel@redhat.com>

diff -uNrp linux-2.6.10.pud/arch/xen/i386/Kconfig linux-2.6.10.misc/arch/xen/i386/Kconfig
--- linux-2.6.10.pud/arch/xen/i386/Kconfig	2005-01-21 20:52:49.077319213 +0100
+++ linux-2.6.10.misc/arch/xen/i386/Kconfig	2005-01-21 21:21:43.918089479 +0100
@@ -253,6 +253,10 @@ config RWSEM_XCHGADD_ALGORITHM
 	depends on !M386
 	default y
 
+config GENERIC_CALIBRATE_DELAY
+	bool
+	default y
+
 config X86_PPRO_FENCE
 	bool
 	depends on M686 || M586MMX || M586TSC || M586 || M486 || M386
diff -uNrp linux-2.6.10.pud/arch/xen/i386/kernel/i386_ksyms.c linux-2.6.10.misc/arch/xen/i386/kernel/i386_ksyms.c
--- linux-2.6.10.pud/arch/xen/i386/kernel/i386_ksyms.c	2005-01-21 20:52:49.084316860 +0100
+++ linux-2.6.10.misc/arch/xen/i386/kernel/i386_ksyms.c	2005-01-21 21:21:10.763235425 +0100
@@ -61,7 +61,6 @@ extern unsigned long get_cmos_time(void)
 
 /* platform dependent support */
 EXPORT_SYMBOL(boot_cpu_data);
-EXPORT_SYMBOL(MCA_bus);
 #ifdef CONFIG_DISCONTIGMEM
 EXPORT_SYMBOL(node_data);
 EXPORT_SYMBOL(physnode_map);
diff -uNrp linux-2.6.10.pud/kernel/sysctl.c linux-2.6.10.misc/kernel/sysctl.c
--- linux-2.6.10.pud/kernel/sysctl.c	2005-01-21 20:52:48.324572272 +0100
+++ linux-2.6.10.misc/kernel/sysctl.c	2005-01-21 21:22:24.013610260 +0100
@@ -642,7 +642,7 @@ static ctl_table kern_table[] = {
 		.proc_handler   = &proc_unknown_nmi_panic,
 	},
 #endif
-#if defined(CONFIG_X86)
+#if defined(CONFIG_X86) && !defined(CONFIG_XEN)
 	{
 		.ctl_name	= KERN_BOOTLOADER_TYPE,
 		.procname	= "bootloader_type",
