From febb72a6e4cc6c8cffcc1ea649a3fb364f1ea432 Mon Sep 17 00:00:00 2001
From: Larry Finger <Larry.Finger@lwfinger.net>
Date: Sun, 6 May 2012 19:40:03 -0500
Subject: IA32 emulation: Fix build problem for modular ia32 a.out support
Patch-mainline: v3.5 or v3.4-rc7 (next release)

Commit ce7e5d2d19bc ("x86: fix broken TASK_SIZE for ia32_aout") breaks
kernel builds when "CONFIG_IA32_AOUT=m" with

  ERROR: "set_personality_ia32" [arch/x86/ia32/ia32_aout.ko] undefined!
  make[1]: *** [__modpost] Error 1

The entry point needs to be exported.

Signed-off-by: Larry Finger <Larry.Finger@lwfinger.net>
Acked-by: Al Viro <viro@zeniv.linux.org>
Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
Acked-by: Jeff Mahoney <jeffm@suse.com>
Automatically created from "patches.rpmify/ia32-emulation-fix-build-problem-for-modular-ia32-a-out-support" by xen-port-patches.py

--- head.orig/arch/x86/kernel/process_64-xen.c	2012-04-13 17:29:01.000000000 +0200
+++ head/arch/x86/kernel/process_64-xen.c	2012-05-08 11:19:08.000000000 +0200
@@ -472,6 +472,7 @@ void set_personality_ia32(bool x32)
 		current_thread_info()->status |= TS_COMPAT;
 	}
 }
+EXPORT_SYMBOL_GPL(set_personality_ia32);
 
 unsigned long get_wchan(struct task_struct *p)
 {
