From: Jiri Slaby <jslaby@suse.cz>
Subject: Linux 3.9.1
Patch-mainline: 3.9.1

Signed-off-by: Jiri Slaby <jslaby@suse.cz>
Automatically created from "patches.kernel.org/patch-3.9.1" by xen-port-patches.py

--- head.orig/arch/x86/kernel/head64-xen.c	2013-04-05 12:38:17.000000000 +0200
+++ head/arch/x86/kernel/head64-xen.c	2013-05-10 14:49:09.000000000 +0200
@@ -36,6 +36,7 @@
 extern pgd_t early_level4_pgt[PTRS_PER_PGD];
 extern pmd_t early_dynamic_pgts[EARLY_DYNAMIC_PAGE_TABLES][PTRS_PER_PMD];
 static unsigned int __initdata next_early_pgt = 2;
+pmdval_t __initdata early_pmd_flags = __PAGE_KERNEL_LARGE & ~(_PAGE_GLOBAL | _PAGE_NX);
 
 /* Wipe all early page tables except for the kernel symbol map */
 static void __init reset_early_page_tables(void)
@@ -101,7 +102,7 @@ again:
 			pmd_p[i] = 0;
 		*pud_p = (pudval_t)pmd_p - __START_KERNEL_map + phys_base + _KERNPG_TABLE;
 	}
-	pmd = (physaddr & PMD_MASK) + (__PAGE_KERNEL_LARGE & ~_PAGE_GLOBAL);
+	pmd = (physaddr & PMD_MASK) + early_pmd_flags;
 	pmd_p[pmd_index(address)] = pmd;
 
 	return 0;
--- head.orig/arch/x86/kernel/irq-xen.c	2012-10-29 17:13:41.000000000 +0100
+++ head/arch/x86/kernel/irq-xen.c	2013-05-10 14:49:09.000000000 +0200
@@ -184,10 +184,6 @@ u64 arch_irq_stat_cpu(unsigned int cpu)
 u64 arch_irq_stat(void)
 {
 	u64 sum = atomic_read(&irq_err_count);
-
-#ifdef CONFIG_X86_IO_APIC
-	sum += atomic_read(&irq_mis_count);
-#endif
 	return sum;
 }
 
