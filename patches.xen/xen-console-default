From: jbeulich@novell.com
Subject: Make Xen console default to vfb if that is built into the kernel
Patch-mainline: obsolete

Index: head-2007-02-08/drivers/xen/console/console.c
===================================================================
--- head-2007-02-08.orig/drivers/xen/console/console.c	2007-02-09 18:04:59.000000000 +0100
+++ head-2007-02-08/drivers/xen/console/console.c	2007-02-09 18:05:13.000000000 +0100
@@ -82,13 +82,19 @@ static int xc_num = -1;
 
 void xencons_early_setup(void)
 {
-	extern int console_use_vt;
-
 	if (is_initial_xendomain()) {
+#ifdef CONFIG_XEN_DISABLE_SERIAL
 		xc_mode = XC_SERIAL;
+#endif
 	} else {
+#ifdef CONFIG_XEN_FRAMEBUFFER
+		xc_mode = XC_XVC;
+#else
+		extern int console_use_vt;
+
 		xc_mode = XC_TTY;
 		console_use_vt = 0;
+#endif
 	}
 }
 
