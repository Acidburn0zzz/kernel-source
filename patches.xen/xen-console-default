From: jbeulich@novell.com
Subject: Make Xen console default to vfb if that is built into the kernel
Patch-mainline: obsolete

---
 drivers/xen/console/console.c |   10 ++++++++--
 1 files changed, 8 insertions(+), 2 deletions(-)

--- linux-2.6.20.orig/drivers/xen/console/console.c
+++ linux-2.6.20/drivers/xen/console/console.c
@@ -82,13 +82,19 @@ static int xc_num = -1;
 
 void xencons_early_setup(void)
 {
-	extern int console_use_vt;
-
 	if (is_initial_xendomain()) {
+#ifdef CONFIG_XEN_DISABLE_SERIAL
 		xc_mode = XC_SERIAL;
+#endif
 	} else {
+#ifdef CONFIG_XEN_FRAMEBUFFER
+		xc_mode = XC_XVC;
+#else
+		extern int console_use_vt;
+
 		xc_mode = XC_TTY;
 		console_use_vt = 0;
+#endif
 	}
 }
 
