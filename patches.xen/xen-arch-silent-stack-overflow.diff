From: Andrea Arcangeli <andrea@suse.de>
Subject: avoid silent stack overflow over the heap
Patch-mainline: no
References: SUSE44807

x

Signed-off-by: Andrea Arcangeli <andrea@suse.de>

Index: linux-2.6.11/arch/xen/i386/mm/fault.c
===================================================================
--- linux-2.6.11.orig/arch/xen/i386/mm/fault.c
+++ linux-2.6.11/arch/xen/i386/mm/fault.c
@@ -312,9 +312,9 @@ fastcall void do_page_fault(struct pt_re
 		 */
 		if (address + 32 < regs->esp)
 			goto bad_area;
 	}
-	if (expand_stack(vma, address))
+	if (expand_stack(vma, address, NULL))
 		goto bad_area;
 /*
  * Ok, we have a good vm_area for this memory access, so
  * we can handle it..
