From: jbeulich@novell.com
Subject: fix placement of some routines/data
Patch-mainline: obsolete

---
 arch/x86/kernel/e820_32-xen.c  |    2 +-
 arch/x86/kernel/traps_32-xen.c |    4 ++--
 arch/x86/kernel/traps_64-xen.c |    4 ++--
 arch/x86/mm/ioremap-xen.c      |    2 +-
 4 files changed, 6 insertions(+), 6 deletions(-)

--- a/arch/x86/kernel/e820_32-xen.c
+++ b/arch/x86/kernel/e820_32-xen.c
@@ -17,7 +17,7 @@
 #include <asm/setup.h>
 #include <xen/interface/memory.h>
 
-struct e820map e820;
+struct e820map __initdata e820;
 struct change_member {
 	struct e820entry *pbios; /* pointer to original bios entry */
 	unsigned long long addr; /* address for this change point */
--- a/arch/x86/kernel/traps_32-xen.c
+++ b/arch/x86/kernel/traps_32-xen.c
@@ -1180,7 +1180,7 @@
  * NB. All these are "trap gates" (i.e. events_mask isn't set) except
  * for those that specify <dpl>|4 in the second field.
  */
-static trap_info_t trap_table[] = {
+static const trap_info_t __cpuinitconst trap_table[] = {
 	{  0, 0, __KERNEL_CS, (unsigned long)divide_error		},
 	{  1, 0|4, __KERNEL_CS, (unsigned long)debug			},
 	{  3, 3|4, __KERNEL_CS, (unsigned long)int3			},
@@ -1236,7 +1236,7 @@
 	cpu_init();
 }
 
-void smp_trap_init(trap_info_t *trap_ctxt)
+void __cpuinit smp_trap_init(trap_info_t *trap_ctxt)
 {
 	const trap_info_t *t = trap_table;
 
--- a/arch/x86/kernel/traps_64-xen.c
+++ b/arch/x86/kernel/traps_64-xen.c
@@ -1195,7 +1195,7 @@
  * NB. All these are "interrupt gates" (i.e. events_mask is set) because we
  * specify <dpl>|4 in the second field.
  */
-static trap_info_t trap_table[] = {
+static const trap_info_t __cpuinitconst trap_table[] = {
         {  0, 0|4, __KERNEL_CS, (unsigned long)divide_error               },
         {  1, 0|4, __KERNEL_CS, (unsigned long)debug                      },
         {  3, 3|4, __KERNEL_CS, (unsigned long)int3                       },
@@ -1236,7 +1236,7 @@
 	cpu_init();
 }
 
-void smp_trap_init(trap_info_t *trap_ctxt)
+void __cpuinit smp_trap_init(trap_info_t *trap_ctxt)
 {
 	const trap_info_t *t = trap_table;
 
--- a/arch/x86/mm/ioremap-xen.c
+++ b/arch/x86/mm/ioremap-xen.c
@@ -190,7 +190,7 @@
 EXPORT_SYMBOL(touch_pte_range);
 
 #ifdef CONFIG_X86_32
-int page_is_ram(unsigned long pagenr)
+int __init page_is_ram(unsigned long pagenr)
 {
 	unsigned long addr, end;
 	int i;
