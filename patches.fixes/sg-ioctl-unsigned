From: Alan Cox
Subject: Fix sign issue in sg_scsi_ioctl()
Patch-mainline: 2.6.10-ac8
References: 49782

The Scsi_Ioctl_Command contains unsigned ints, it however reads out
singed ints for in_len and out_len.
 
They are later compared > PAGE_SIZE and not checked for underflow.

Acked-by: 
Signed-off-by: Jens Axboe <axboe@suse.de>

diff -u --new-file --recursive --exclude-from /usr/src/exclude linux.vanilla-2.6.10/drivers/block/scsi_ioctl.c linux-2.6.10/drivers/block/scsi_ioctl.c
--- linux.vanilla-2.6.10/drivers/block/scsi_ioctl.c	2004-12-25 21:15:34.000000000 +0000
+++ linux-2.6.10/drivers/block/scsi_ioctl.c	2005-01-07 23:12:02.000000000 +0000
@@ -339,7 +339,8 @@
 			 struct gendisk *bd_disk, Scsi_Ioctl_Command __user *sic)
 {
 	struct request *rq;
-	int err, in_len, out_len, bytes, opcode, cmdlen;
+	unsigned int bytes, opcode, cmdlen, in_len, out_len;
+	int err;
 	char *buffer = NULL, sense[SCSI_SENSE_BUFFERSIZE];
 
 	/*

