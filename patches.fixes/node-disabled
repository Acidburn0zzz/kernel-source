diff -u linux-2.6.5-amd64/include/asm-i386/cpu.h-o linux-2.6.5-amd64/include/asm-i386/cpu.h
--- linux-2.6.5-amd64/include/asm-i386/cpu.h-o	2004-03-21 21:11:56.000000000 +0100
+++ linux-2.6.5-amd64/include/asm-i386/cpu.h	2004-04-05 18:29:12.000000000 +0200
@@ -17,7 +17,11 @@
 	struct node *parent = NULL;
 	
 #ifdef CONFIG_NUMA
-	parent = &node_devices[cpu_to_node(num)].node;
+	int node = cpu_to_node(num);
+
+	if (!node_online(node))
+		return 0; 
+	parent = &node_devices[node].node;
 #endif /* CONFIG_NUMA */
 
 	return register_cpu(&cpu_devices[num].cpu, num, parent);
