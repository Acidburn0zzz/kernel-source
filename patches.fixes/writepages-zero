mason@suse.com

Bugfix for 42748

We might erroneously not zero out the last page in a multipage
write case.

--- linux.t.orig/fs/mpage.c     2004-07-01 11:07:17.000000000 -0400 
+++ linux.t/fs/mpage.c  2004-07-08 12:51:44.915892528 -0400 
@@ -490,6 +489,8 @@ mpage_writepage(struct bio *bio, struct
 
 	first_unmapped = page_block;
 
+page_is_mapped:
+
 	end_index = i_size_read(inode) >> PAGE_CACHE_SHIFT;
 	if (page->index >= end_index) {
 		unsigned offset = i_size_read(inode) & (PAGE_CACHE_SIZE - 1);
@@ -503,8 +504,6 @@ mpage_writepage(struct bio *bio, struct
 		kunmap_atomic(kaddr, KM_USER0);
 	}
 
-page_is_mapped:
-
 	/*
 
