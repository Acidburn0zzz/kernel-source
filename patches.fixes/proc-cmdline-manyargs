--- linux-2.6.8/fs/proc/base.c.manyargs	2004-08-16 11:42:18.000000000 +0200
+++ linux-2.6.8/fs/proc/base.c	2004-08-16 12:21:10.690115825 +0200
@@ -343,7 +343,7 @@
 
 	// If the nul at the end of args has been overwritten, then
 	// assume application is using setproctitle(3).
-	if (res > 0 && buffer[res-1] != '\0') {
+	if (res > 0 && buffer[res-1] != '\0' && len < PAGE_SIZE) {
 		len = strnlen(buffer, res);
 		if (len < res) {
 		    res = len;
