# This is a BitKeeper generated diff -Nru style patch.
#
# ChangeSet
#   2004/09/29 09:27:51+02:00 hare@lammermuir.suse.de 
#   We really should cancel I/O requests before removing the host.
#   
#   Signed-off-by: Hannes Reinecke <hare@suse.de>
# 
# drivers/scsi/hosts.c
#   2004/09/29 09:27:46+02:00 hare@lammermuir.suse.de +1 -1
#   Change ordering to cancel I/O-request before removing the host.
# 
diff -Nru a/drivers/scsi/hosts.c b/drivers/scsi/hosts.c
--- a/drivers/scsi/hosts.c	2004-09-29 09:29:19 +02:00
+++ b/drivers/scsi/hosts.c	2004-09-29 09:29:19 +02:00
@@ -75,8 +75,8 @@
  **/
 void scsi_remove_host(struct Scsi_Host *shost)
 {
-	scsi_forget_host(shost);
 	scsi_host_cancel(shost, 0);
+	scsi_forget_host(shost);
 	scsi_proc_host_rm(shost);
 
 	set_bit(SHOST_DEL, &shost->shost_state);
