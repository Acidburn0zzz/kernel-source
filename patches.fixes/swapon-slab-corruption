diff -urNp linux-2.6.4/mm/swapfile.c linux-2.6.4.SUSE/mm/swapfile.c
--- linux-2.6.4/mm/swapfile.c	2004-03-15 17:47:50.000000000 +0100
+++ linux-2.6.4.SUSE/mm/swapfile.c	2004-03-15 17:48:21.000000000 +0100
@@ -1330,8 +1330,10 @@ asmlinkage long sys_swapon(const char __
 	swap_list_unlock();
 	name = getname(specialfile);
 	error = PTR_ERR(name);
-	if (IS_ERR(name))
+	if (IS_ERR(name)) {
+		name = NULL;
 		goto bad_swap_2;
+	}
 	swap_file = filp_open(name, O_RDWR, 0);
 	error = PTR_ERR(swap_file);
 	if (IS_ERR(swap_file)) {
