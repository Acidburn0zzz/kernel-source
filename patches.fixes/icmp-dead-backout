--- linux-2.6.4/net/ipv4/igmp.c~	2004-03-26 17:32:51.040696332 +0100
+++ linux-2.6.4/net/ipv4/igmp.c	2004-03-26 17:33:13.848219809 +0100
@@ -1068,7 +1068,7 @@
 	reporter = im->reporter;
 	igmp_stop_timer(im);
 
-	if (!in_dev->dead) {
+	if (in_dev->dev->flags & IFF_UP) {
 		if (IGMP_V1_SEEN(in_dev))
 			goto done;
 		if (IGMP_V2_SEEN(in_dev)) {
@@ -1099,8 +1099,6 @@
 	if (im->multiaddr == IGMP_ALL_HOSTS)
 		return;
 
-	if (in_dev->dead)
-		return;
 	if (IGMP_V1_SEEN(in_dev) || IGMP_V2_SEEN(in_dev)) {
 		spin_lock_bh(&im->lock);
 		igmp_start_timer(im, IGMP_Initial_Report_Delay);
@@ -1174,7 +1172,7 @@
 	igmpv3_del_delrec(in_dev, im->multiaddr);
 #endif
 	igmp_group_added(im);
-	if (!in_dev->dead)
+	if (in_dev->dev->flags & IFF_UP)
 		ip_rt_multicast_event(in_dev);
 out:
 	return;
@@ -1198,7 +1196,7 @@
 				write_unlock_bh(&in_dev->lock);
 				igmp_group_dropped(i);
 
-				if (!in_dev->dead)
+				if (in_dev->dev->flags & IFF_UP)
 					ip_rt_multicast_event(in_dev);
 
 				ip_ma_put(i);
@@ -1279,9 +1277,6 @@
 
 	ASSERT_RTNL();
 
-	/* Deactivate timers */
-	ip_mc_down(in_dev);
-
 	write_lock_bh(&in_dev->lock);
 	while ((i = in_dev->mc_list) != NULL) {
 		in_dev->mc_list = i->next;
