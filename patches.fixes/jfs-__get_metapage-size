# This is a BitKeeper generated diff -Nru style patch.
#
# ChangeSet
#   2004/05/18 15:36:21-05:00 shaggy@austin.ibm.com 
#   JFS: error in __get_metapage caused by invalid size from ea_get
# 
diff -Nru a/fs/jfs/xattr.c b/fs/jfs/xattr.c
--- a/fs/jfs/xattr.c	2004-05-20 16:47:18 -05:00
+++ b/fs/jfs/xattr.c	2004-05-20 16:47:18 -05:00
@@ -550,7 +550,8 @@
 	}
 	ea_buf->flag = EA_EXTENT;
 	ea_buf->mp = read_metapage(inode, addressDXD(&ji->ea),
-				   lengthDXD(&ji->ea), 1);
+				   lengthDXD(&ji->ea) << sb->s_blocksize_bits,
+				   1);
 	if (ea_buf->mp == NULL)
 		return -EIO;
 	ea_buf->xattr = ea_buf->mp->data;
_______________________________________________
Jfs-patches mailing list
Jfs-patches@www-124.ibm.com
http://www-124.ibm.com/developerworks/oss/mailman/listinfo/jfs-patches


