--- linux-2.6.5/kernel/compat.c.foo	2004-06-17 13:49:51.000000000 +0200
+++ linux-2.6.5/kernel/compat.c	2004-06-17 13:50:46.000000000 +0200
@@ -416,11 +416,9 @@
 				for (j = 0; j < sizeof(m)/sizeof(um); j++ ) {
 					if (__get_user(um, user_mask_ptr))
 						return -EFAULT;
 					user_mask_ptr++;
-					m <<= 4*sizeof(um);
-					m <<= 4*sizeof(um);
-					m |= um;
+					m |= (unsigned long)um << (8*sizeof(um)*j);
 				}
 				*k++ = m;
 			}
 		}
