#date: 2004-04-23
#id: 1.1371.744.2
#tag: other
#time: 12:12:25
#title: NTFS: Move a few assignments after a NULL check in fs/ntfs/attrib.c.
#who: aia21@cantab.net
#
# ChangeSet
#   1.1371.744.2 04/04/23 12:12:25 aia21@cantab.net +1 -0
#   NTFS: Move a few assignments after a NULL check in fs/ntfs/attrib.c.
#
# fs/ntfs/attrib.c +6 -3
#   Move assignments after NULL check.
#
diff -Nru a/fs/ntfs/attrib.c b/fs/ntfs/attrib.c
--- a/fs/ntfs/attrib.c	Wed Apr 28 10:44:41 2004
+++ b/fs/ntfs/attrib.c	Wed Apr 28 10:44:41 2004
@@ -1235,11 +1235,11 @@
 	u8 *al_end = al + initialized_size;
 	run_list_element *rl;
 	struct buffer_head *bh;
-	struct super_block *sb = vol->sb;
-	unsigned long block_size = sb->s_blocksize;
+	struct super_block *sb;
+	unsigned long block_size;
 	unsigned long block, max_block;
 	int err = 0;
-	unsigned char block_size_bits = sb->s_blocksize_bits;
+	unsigned char block_size_bits;
 
 	ntfs_debug("Entering.");
 	if (!vol || !run_list || !al || size <= 0 || initialized_size < 0 ||
@@ -1249,6 +1249,9 @@
 		memset(al, 0, size);
 		return 0;
 	}
+	sb = vol->sb;
+	block_size = sb->s_blocksize;
+	block_size_bits = sb->s_blocksize_bits;
 	down_read(&run_list->lock);
 	rl = run_list->rl;
 	/* Read all clusters specified by the run list one run at a time. */
