# This is a BitKeeper generated diff -Nru style patch.
#
# ChangeSet
#   2004/05/05 10:15:28-07:00 sri@us.ibm.com 
#   [SCTP] Fix accessing Gap Ack blocks array with a -ve index in
#   sctp_outq_sack()
# 
# net/sctp/outqueue.c
#   2004/05/05 10:14:57-07:00 sri@us.ibm.com +4 -2
#   [SCTP] Fix accessing Gap Ack blocks array with a -ve index in
#   sctp_outq_sack()
# 
diff -Nru a/net/sctp/outqueue.c b/net/sctp/outqueue.c
--- a/net/sctp/outqueue.c	Tue May 11 06:17:38 2004
+++ b/net/sctp/outqueue.c	Tue May 11 06:17:38 2004
@@ -1056,8 +1056,10 @@
 	}
 
 	/* Get the highest TSN in the sack. */
-	highest_tsn = sack_ctsn +
-		ntohs(frags[ntohs(sack->num_gap_ack_blocks) - 1].gab.end);
+	highest_tsn = sack_ctsn;
+	if (sack->num_gap_ack_blocks)
+		highest_tsn +=
+		    ntohs(frags[ntohs(sack->num_gap_ack_blocks) - 1].gab.end);
 
 	if (TSN_lt(asoc->highest_sacked, highest_tsn)) {
 		highest_new_tsn = highest_tsn;
