diff -u linux/arch/i386/kernel/smpboot.c-o linux/arch/i386/kernel/smpboot.c
--- linux/arch/i386/kernel/smpboot.c-o	2004-05-26 14:20:22.000000000 +0200
+++ linux/arch/i386/kernel/smpboot.c	2004-05-26 20:16:42.000000000 +0200
@@ -1116,8 +1116,10 @@
 			cpu_set(cpu, cpu_sibling_map[cpu]);
 		}
 
-		if (siblings != smp_num_siblings)
+		if (siblings != smp_num_siblings) {
 			printk(KERN_WARNING "WARNING: %d siblings found for CPU%d, should be %d\n", siblings, cpu, smp_num_siblings);
+			smp_num_siblings = siblings;
+		}
 	}
 
 	smpboot_setup_io_apic();
diff -u linux/arch/x86_64/kernel/smpboot.c-o linux/arch/x86_64/kernel/smpboot.c
--- linux/arch/x86_64/kernel/smpboot.c-o	2004-05-26 14:20:21.000000000 +0200
+++ linux/arch/x86_64/kernel/smpboot.c	2004-05-26 20:16:16.000000000 +0200
@@ -900,10 +900,12 @@
 			cpu_set(cpu, cpu_sibling_map[cpu]);
 		}
 
-		if (siblings != smp_num_siblings)
+		if (siblings != smp_num_siblings) {
 			printk(KERN_WARNING 
 	       "WARNING: %d siblings found for CPU%d, should be %d\n", 
 			       siblings, cpu, smp_num_siblings);
+			smp_num_siblings = siblings;
+		}
 	}
 
 	Dprintk("Boot done.\n");
