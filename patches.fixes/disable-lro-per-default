From: Karsten Keil <kkeil@novell.com>
Subject: Disable LRO per default in igb and ixgbe
Reference: bnc#467519

iSCSI with LRO enabled causes a kernel panic.
This happens because skb_seq_read doesn't handle LRO well.
So disabling LRO per default, until skb_seq_read is not longer used
or fixed. 


---
 drivers/net/igb/igb_main.c     |    2 ++
 drivers/net/ixgbe/ixgbe_main.c |    2 ++
 2 files changed, 4 insertions(+)

--- a/drivers/net/igb/igb_main.c
+++ b/drivers/net/igb/igb_main.c
@@ -1118,8 +1118,10 @@ static int __devinit igb_probe(struct pc
 	netdev->features |= NETIF_F_TSO6;
 
 #ifdef CONFIG_IGB_LRO
+#ifdef IGB_LRO_DEFAULT_ON
 	netdev->features |= NETIF_F_LRO;
 #endif
+#endif
 
 	netdev->vlan_features |= NETIF_F_TSO;
 	netdev->vlan_features |= NETIF_F_TSO6;
--- a/drivers/net/ixgbe/ixgbe_main.c
+++ b/drivers/net/ixgbe/ixgbe_main.c
@@ -3844,8 +3844,10 @@ static int __devinit ixgbe_probe(struct 
 	netdev->features |= NETIF_F_TSO;
 	netdev->features |= NETIF_F_TSO6;
 #ifdef CONFIG_IXGBE_LRO
+#ifdef IXGBE_LRO_DEFAULT_ON
 	netdev->features |= NETIF_F_LRO;
 #endif
+#endif
 
 	netdev->vlan_features |= NETIF_F_TSO;
 	netdev->vlan_features |= NETIF_F_TSO6;
