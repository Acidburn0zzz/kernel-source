From: Karsten Keil <kkeil@novell.com>
Subject: Disable LRO per default in igb and ixgbe
Reference: bnc#467519

iSCSI with LRO enabled causes a kernel panic.
This happens because skb_seq_read doesn't handle LRO well.
So disabling LRO per default, until skb_seq_read is not longer used
or fixed. 


Index: linux-2.6.27/drivers/net/igb/igb_main.c
===================================================================
--- linux-2.6.27.orig/drivers/net/igb/igb_main.c
+++ linux-2.6.27/drivers/net/igb/igb_main.c
@@ -1118,8 +1118,10 @@ static int __devinit igb_probe(struct pc
 	netdev->features |= NETIF_F_TSO6;
 
 #ifdef CONFIG_IGB_LRO
+#ifdef IGB_LRO_DEFAULT_ON
 	netdev->features |= NETIF_F_LRO;
 #endif
+#endif
 
 	netdev->vlan_features |= NETIF_F_TSO;
 	netdev->vlan_features |= NETIF_F_TSO6;
Index: linux-2.6.27/drivers/net/ixgbe/ixgbe_main.c
===================================================================
--- linux-2.6.27.orig/drivers/net/ixgbe/ixgbe_main.c
+++ linux-2.6.27/drivers/net/ixgbe/ixgbe_main.c
@@ -4112,8 +4112,10 @@ static int __devinit ixgbe_probe(struct 
 	netdev->features |= NETIF_F_TSO;
 	netdev->features |= NETIF_F_TSO6;
 #ifdef CONFIG_IXGBE_LRO
+#ifdef IXGBE_LRO_DEFAULT_ON
 	netdev->features |= NETIF_F_LRO;
 #endif
+#endif
 
 	netdev->vlan_features |= NETIF_F_TSO;
 	netdev->vlan_features |= NETIF_F_TSO6;
