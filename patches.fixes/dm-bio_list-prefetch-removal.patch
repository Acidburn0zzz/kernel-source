From: Alasdair G Kergon <agk@redhat.com>
Subject: Remove dubious prefetch from bio_list_for_each() macro.

Cc: Jens Axboe <jens.axboe@oracle.com>
Signed-off-by: Alasdair G Kergon <agk@redhat.com>
Signed-off-by: Hannes Reinecke <hare@suse.de>
---
 drivers/md/dm-bio-list.h |    4 +---
 1 files changed, 1 insertion(+), 3 deletions(-)

Index: linux/drivers/md/dm-bio-list.h
===================================================================
--- linux.orig/drivers/md/dm-bio-list.h	2007-07-12 16:54:00.000000000 +0100
+++ linux/drivers/md/dm-bio-list.h	2007-07-12 17:03:57.000000000 +0100
@@ -8,7 +8,6 @@
 #define DM_BIO_LIST_H
 
 #include <linux/bio.h>
-#include <linux/prefetch.h>
 
 struct bio_list {
 	struct bio *head;
@@ -31,8 +30,7 @@ static inline void bio_list_init(struct 
 }
 
 #define bio_list_for_each(bio, bl) \
-	for (bio = (bl)->head; bio && ({ prefetch(bio->bi_next); 1; }); \
-	     bio = bio->bi_next)
+	for (bio = (bl)->head; bio; bio = bio->bi_next)
 
 static inline unsigned bio_list_size(const struct bio_list *bl)
 {
