diff -urNp linux-2.6.5/mm/memory.c linux-2.6.5.SUSE/mm/memory.c
--- linux-2.6.5/mm/memory.c	2004-10-26 15:33:18.805845194 +0200
+++ linux-2.6.5.SUSE/mm/memory.c	2004-10-26 15:35:22.914939679 +0200
@@ -825,7 +825,7 @@ int get_user_pages(struct task_struct *t
 			}
 			if (pages) {
 				pages[i] = get_page_map(map);
-				if (!pages[i]) {
+				if (!pages[i] || PageReserved(pages[i])) {
 					spin_unlock(&mm->page_table_lock);
 					while (i--)
 						page_cache_release(pages[i]);
@@ -833,8 +833,7 @@ int get_user_pages(struct task_struct *t
 					goto out;
 				}
 				flush_dcache_page(pages[i]);
-				if (!PageReserved(pages[i]))
-					page_cache_get(pages[i]);
+				page_cache_get(pages[i]);
 			}
 			if (vmas)
 				vmas[i] = vma;
