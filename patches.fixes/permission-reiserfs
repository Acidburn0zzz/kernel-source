Index: linux-2.6.0/fs/reiserfs/xattr.c
===================================================================
--- linux-2.6.0.orig/fs/reiserfs/xattr.c	2004-01-05 12:59:45.000000000 +0100
+++ linux-2.6.0/fs/reiserfs/xattr.c	2004-01-05 13:00:00.000000000 +0100
@@ -1362,7 +1362,8 @@ check_capabilities:
 	 * Read/write DACs are always overridable.
 	 * Executable DACs are overridable if at least one exec bit is set.
 	 */
-	if ((mask & (MAY_READ|MAY_WRITE)) || (inode->i_mode & S_IXUGO))
+	if (!(mask & MAY_EXEC) ||
+		(inode->i_mode & S_IXUGO) || S_ISDIR(inode->i_mode))
 		if (capable(CAP_DAC_OVERRIDE))
 			return 0;
 
