--- linux-2.6.8/drivers/input/input.c.orig	2004-09-27 14:10:12.750577602 +0200
+++ linux-2.6.8/drivers/input/input.c	2004-09-27 14:15:52.236118529 +0200
@@ -507,7 +507,8 @@
 	
 	dev->cdev.dev = get_device(dev->dev);
 	if (class_device_register(&dev->cdev)) {
-		put_device(dev->dev);
+		if (dev->dev)
+			put_device(dev->dev);
 		return;
 	}
 
--- linux-2.6.8/drivers/macintosh/mac_hid.c.orig	2004-08-14 07:37:39.000000000 +0200
+++ linux-2.6.8/drivers/macintosh/mac_hid.c	2004-09-27 14:14:08.067587803 +0200
@@ -119,6 +119,7 @@
 	emumousebtn.id.vendor = 0x0001;
 	emumousebtn.id.product = 0x0001;
 	emumousebtn.id.version = 0x0100;
+	sprintf(emumousebtn.cdev.class_id,"emumousebtn");
 
 	input_register_device(&emumousebtn);
 
--- linux-2.6.8/drivers/macintosh/adbhid.c.orig	2004-09-27 14:44:26.748539233 +0200
+++ linux-2.6.8/drivers/macintosh/adbhid.c	2004-09-27 14:48:55.149689498 +0200
@@ -574,6 +574,7 @@
 	adbhid[id]->input.id.vendor = 0x0001;
 	adbhid[id]->input.id.product = (id << 12) | (default_id << 8) | original_handler_id;
 	adbhid[id]->input.id.version = 0x0100;
+	sprintf(adbhid[id]->input.cdev.class_id,"adbhid%d", id);
 
 	switch (default_id) {
 	case ADB_KEYBOARD:
