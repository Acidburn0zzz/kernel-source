From: Marcel Holtmann <holtmann@suse.de>
Subject: bluetooth: Fix signedness problem at socket creation
Patch-mainline: no
References: 74519

bluetooth: Fix signedness problem at socket creation

Signed-off-by: Marcel Holtmann <holtmann@suse.de>
Acked-by: meissner@suse.de

# This is a BitKeeper generated diff -Nru style patch.
#
# ChangeSet
#   2005/03/25 00:26:46+01:00 marcel@holtmann.org 
#   [Bluetooth] Fix signedness problem at socket creation
#   
#   This patch fixes a small signedness problem when creating the
#   socket.
#   
#   Signed-off-by: Marcel Holtmann <marcel@holtmann.org>
# 
# net/bluetooth/af_bluetooth.c
#   2005/03/25 00:23:06+01:00 marcel@holtmann.org +3 -3
#   Fix signedness problem at socket creation
# 
diff -Nru a/net/bluetooth/af_bluetooth.c b/net/bluetooth/af_bluetooth.c
--- a/net/bluetooth/af_bluetooth.c	2005-03-25 00:39:07 +01:00
+++ b/net/bluetooth/af_bluetooth.c	2005-03-25 00:39:07 +01:00
@@ -62,7 +62,7 @@
 
 int bt_sock_register(int proto, struct net_proto_family *ops)
 {
-	if (proto >= BT_MAX_PROTO)
+	if (proto < 0 || proto >= BT_MAX_PROTO)
 		return -EINVAL;
 
 	if (bt_proto[proto])
@@ -75,7 +75,7 @@
 
 int bt_sock_unregister(int proto)
 {
-	if (proto >= BT_MAX_PROTO)
+	if (proto < 0 || proto >= BT_MAX_PROTO)
 		return -EINVAL;
 
 	if (!bt_proto[proto])
@@ -90,7 +90,7 @@
 {
 	int err = 0;
 
-	if (proto >= BT_MAX_PROTO)
+	if (proto < 0 || proto >= BT_MAX_PROTO)
 		return -EINVAL;
 
 #if defined(CONFIG_KMOD)
