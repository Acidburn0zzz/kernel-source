# Date: Mon, 10 May 2004 16:24:04 +1000 (EST)
# From: Nathan Scott <nathans@snort.melbourne.sgi.com>
# Subject: TAKE 914274 - fix some warnings
# 
# Fix some compiler warnings, mark cmn_err as printflike.
# Resolves the issue Meelis Roos reported recently on lkml.
# 
# Date:  Sun May  9 23:21:15 PDT 2004
# Workarea:  snort.melbourne.sgi.com:/home/nathans/ultra-clean-xfs-linux
# Inspected by:  tes@sgi.com
# 
# The following file(s) were checked into:
#   bonnie.engr.sgi.com:/isms/xfs-kern/xfs-linux

Index: linux-2.6.5/fs/xfs/support/debug.h
===================================================================
--- linux-2.6.5.orig/fs/xfs/support/debug.h
+++ linux-2.6.5/fs/xfs/support/debug.h
@@ -1,5 +1,5 @@
 /*
- * Copyright (c) 2000-2002 Silicon Graphics, Inc.  All Rights Reserved.
+ * Copyright (c) 2000-2004 Silicon Graphics, Inc.  All Rights Reserved.
  *
  * This program is free software; you can redistribute it and/or modify it
  * under the terms of version 2 of the GNU General Public License as
@@ -42,6 +42,7 @@
 #define CE_PANIC        0               /* panic        */
 
 extern void icmn_err(int, char *, va_list);
+/* PRINTFLIKE2 */
 extern void cmn_err(int, char *, ...);
 
 #ifndef STATIC
Index: linux-2.6.5/fs/xfs/xfs_buf_item.c
===================================================================
--- linux-2.6.5.orig/fs/xfs/xfs_buf_item.c
+++ linux-2.6.5/fs/xfs/xfs_buf_item.c
@@ -1,5 +1,5 @@
 /*
- * Copyright (c) 2000-2002 Silicon Graphics, Inc.  All Rights Reserved.
+ * Copyright (c) 2000-2004 Silicon Graphics, Inc.  All Rights Reserved.
  *
  * This program is free software; you can redistribute it and/or modify it
  * under the terms of version 2 of the GNU General Public License as
@@ -1053,9 +1053,9 @@ xfs_buf_iodone_callbacks(
 		    (time_after(jiffies, (lasttime + 5*HZ)))) {
 			lasttime = jiffies;
 			prdev("XFS write error in file system meta-data "
-			      "block 0x%Lx in %s",
+			      "block 0x%llx in %s",
 			      XFS_BUF_TARGET(bp),
-			      XFS_BUF_ADDR(bp), mp->m_fsname);
+			      (__uint64_t)XFS_BUF_ADDR(bp), mp->m_fsname);
 		}
 		lasttarg = XFS_BUF_TARGET(bp);
 
Index: linux-2.6.5/fs/xfs/xfs_da_btree.c
===================================================================
--- linux-2.6.5.orig/fs/xfs/xfs_da_btree.c
+++ linux-2.6.5/fs/xfs/xfs_da_btree.c
@@ -1,5 +1,5 @@
 /*
- * Copyright (c) 2000-2003 Silicon Graphics, Inc.  All Rights Reserved.
+ * Copyright (c) 2000-2004 Silicon Graphics, Inc.  All Rights Reserved.
  *
  * This program is free software; you can redistribute it and/or modify it
  * under the terms of version 2 of the GNU General Public License as
@@ -2166,9 +2166,9 @@ xfs_da_do_buf(
 					cmn_err(CE_ALERT,
 						"[%02d] br_startoff %lld br_startblock %lld br_blockcount %lld br_state %d\n",
 						i,
-						mapp[i].br_startoff,
-						mapp[i].br_startblock,
-						mapp[i].br_blockcount,
+						(long long)mapp[i].br_startoff,
+						(long long)mapp[i].br_startblock,
+						(long long)mapp[i].br_blockcount,
 						mapp[i].br_state);
 				}
 			}
