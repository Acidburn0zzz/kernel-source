#date: 2004-04-17
#from: Dave Jones <davej@redhat.com>
#id: 1.1371.718.31
#tag: via-mm
#time: 17:29:32
#title: aty128fb dereference before null check
#who: akpm@osdl.org[torvalds]
#
# ChangeSet
#   1.1371.718.31 04/04/17 17:29:32 akpm@osdl.org[torvalds] +1 -0
#   [PATCH] aty128fb dereference before null check
#   
#   From: Dave Jones <davej@redhat.com>
#
# drivers/video/aty/aty128fb.c +3 -1
#
diff -Nru a/drivers/video/aty/aty128fb.c b/drivers/video/aty/aty128fb.c
--- a/drivers/video/aty/aty128fb.c	Wed Apr 28 00:39:41 2004
+++ b/drivers/video/aty/aty128fb.c	Wed Apr 28 00:39:41 2004
@@ -1998,10 +1998,12 @@
 static void __devexit aty128_remove(struct pci_dev *pdev)
 {
 	struct fb_info *info = pci_get_drvdata(pdev);
-	struct aty128fb_par *par = info->par;
+	struct aty128fb_par *par;
 
 	if (!info)
 		return;
+
+	par = info->par;
 
 	unregister_framebuffer(info);
 #ifdef CONFIG_MTRR
