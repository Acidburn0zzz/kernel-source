From: Jens Axboe <axboe@suse.de>
Subject: Fixup error in cfq-pending-work
Patch-mainline: 
References: 

See subject

Acked-by: 
Signed-off-by: 

--- linux-2.6.11/drivers/block/cfq-iosched.c~	2005-03-16 22:27:51.000000000 +0100
+++ linux-2.6.11/drivers/block/cfq-iosched.c	2005-03-16 22:29:32.000000000 +0100
@@ -1726,14 +1726,14 @@ cfq_insert_request(request_queue_t *q, s
 
 static inline int cfq_pending_requests(struct cfq_data *cfqd)
 {
-	return list_empty(&cfqd->queue->queue_head) && !cfqd->busy_queues;
+	return !list_empty(&cfqd->queue->queue_head) || cfqd->busy_queues;
 }
 
 static int cfq_queue_empty(request_queue_t *q)
 {
 	struct cfq_data *cfqd = q->elevator->elevator_data;
 
-	return cfq_pending_requests(cfqd);
+	return !cfq_pending_requests(cfqd);
 }
 
 static void cfq_completed_request(request_queue_t *q, struct request *rq)
