Date: Thu, 3 Jun 2004 18:29:04 -0700 (PDT)
From: Jesse Brandeburg <jesse.brandeburg@intel.com>
To: jgarzik@pobox.com
Cc: netdev@oss.sgi.com, <jesse.brandeburg@intel.com>
Subject: [PATCH 2.5] e1000: fix napi crash on ifdown during traffic
Sender: netdev-bounce@oss.sgi.com


Signed off by: Jesse Brandeburg

diff -Naurp linux-2.5/drivers/net/e1000/e1000_main.c linux-2.5/drivers/net/e1000.mod/e1000_main.c
--- linux-2.5/drivers/net/e1000/e1000_main.c	2004-06-03 17:57:55.000000000 -0700
+++ linux-2.5/drivers/net/e1000.mod/e1000_main.c	2004-06-03 17:59:04.000000000 -0700
@@ -2143,6 +2143,7 @@ e1000_clean(struct net_device *netdev, i
 	if(work_done < work_to_do || !netif_running(netdev)) {
 		netif_rx_complete(netdev);
 		e1000_irq_enable(adapter);
+		return 0;
 	}
 
 	return (work_done >= work_to_do);

