From: Giancarlo Formicuccia <giancarlo.formicuccia@gmail.com>
Subject: New task structures need to zero ->fs_excl
Patch-mainline: 
References: 

It doesn't make sense to inherit the parents fs_excl count, in fact it
screws up the accounting.

Acked-by: 
Signed-off-by: Jens Axboe <axboe@suse.de>

--- linux-2.6.13/kernel/fork.c~	2005-09-08 10:19:32.000000000 +0200
+++ linux-2.6.13/kernel/fork.c	2005-09-08 10:19:49.000000000 +0200
@@ -174,6 +174,7 @@ static struct task_struct *dup_task_stru
 	*tsk = *orig;
 	tsk->thread_info = ti;
 	ti->task = tsk;
+	atomic_set(&tsk->fs_excl, 0);
 
 	/* One for us, one for whoever does the "release_task()" (usually parent) */
 	atomic_set(&tsk->usage,2);
