From: linus@osdl.org
Subject: write correct values to pci config space


Signed-off-by: Olaf Hering <olh@suse.de>

 drivers/ide/pci/cmd64x.c |    2 +-
 drivers/ide/pci/hpt34x.c |    2 +-
 2 files changed, 2 insertions(+), 2 deletions(-)

Index: linux-2.6.13-pci-rom-corruption/drivers/ide/pci/cmd64x.c
===================================================================
--- linux-2.6.13-pci-rom-corruption.orig/drivers/ide/pci/cmd64x.c
+++ linux-2.6.13-pci-rom-corruption/drivers/ide/pci/cmd64x.c
@@ -608,7 +608,7 @@ static unsigned int __devinit init_chips
 
 #ifdef __i386__
 	if (dev->resource[PCI_ROM_RESOURCE].start) {
-		pci_write_config_byte(dev, PCI_ROM_ADDRESS, dev->resource[PCI_ROM_RESOURCE].start | PCI_ROM_ADDRESS_ENABLE);
+		pci_write_config_dword(dev, PCI_ROM_ADDRESS, dev->resource[PCI_ROM_RESOURCE].start | PCI_ROM_ADDRESS_ENABLE);
 		printk(KERN_INFO "%s: ROM enabled at 0x%08lx\n", name, dev->resource[PCI_ROM_RESOURCE].start);
 	}
 #endif
Index: linux-2.6.13-pci-rom-corruption/drivers/ide/pci/hpt34x.c
===================================================================
--- linux-2.6.13-pci-rom-corruption.orig/drivers/ide/pci/hpt34x.c
+++ linux-2.6.13-pci-rom-corruption/drivers/ide/pci/hpt34x.c
@@ -173,7 +173,7 @@ static unsigned int __devinit init_chips
 
 	if (cmd & PCI_COMMAND_MEMORY) {
 		if (pci_resource_start(dev, PCI_ROM_RESOURCE)) {
-			pci_write_config_byte(dev, PCI_ROM_ADDRESS,
+			pci_write_config_dword(dev, PCI_ROM_ADDRESS,
 				dev->resource[PCI_ROM_RESOURCE].start | PCI_ROM_ADDRESS_ENABLE);
 			printk(KERN_INFO "HPT345: ROM enabled at 0x%08lx\n",
 				dev->resource[PCI_ROM_RESOURCE].start);
