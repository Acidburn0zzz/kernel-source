diff -urNp linux-2.6.5/fs/compat.c linux-2.6.5.SUSE/fs/compat.c
--- linux-2.6.5/fs/compat.c	2004-10-13 15:54:41.307310536 +0200
+++ linux-2.6.5.SUSE/fs/compat.c	2004-10-13 15:54:52.731573784 +0200
@@ -566,8 +566,15 @@ asmlinkage long compat_sys_fcntl64(unsig
 		ret = sys_fcntl(fd, cmd, (unsigned long)&f);
 		set_fs(old_fs);
 		if ((cmd == F_GETLK) && (ret == 0)) {
+			/* POSIX-2001 now defines negative l_len from fcntl man page */
+			if (f.l_len < 0) {	
+				f.l_start += f.l_len;
+				f.l_len = -f.l_len;
+			}
+			if (f.l_start < 0) 
+				return -EINVAL;
 			if ((f.l_start >= COMPAT_OFF_T_MAX) ||
-			    ((f.l_start + f.l_len) >= COMPAT_OFF_T_MAX))
+			    ((f.l_start + f.l_len) > COMPAT_OFF_T_MAX))
 				ret = -EOVERFLOW;
 			if (ret == 0)
 				ret = put_compat_flock(&f, compat_ptr(arg));
@@ -587,8 +594,15 @@ asmlinkage long compat_sys_fcntl64(unsig
 				(unsigned long)&f);
 		set_fs(old_fs);
 		if ((cmd == F_GETLK64) && (ret == 0)) {
+			/* POSIX-2001 now defines negative l_len from fcntl man page */
+                        if (f.l_len < 0) {
+                                f.l_start += f.l_len;
+                                f.l_len = -f.l_len;
+                        }
+                        if (f.l_start < 0)
+                                return -EINVAL;
 			if ((f.l_start >= COMPAT_LOFF_T_MAX) ||
-			    ((f.l_start + f.l_len) >= COMPAT_LOFF_T_MAX))
+			    ((f.l_start + f.l_len) > COMPAT_LOFF_T_MAX))
 				ret = -EOVERFLOW;
 			if (ret == 0)
 				ret = put_compat_flock64(&f, compat_ptr(arg));
