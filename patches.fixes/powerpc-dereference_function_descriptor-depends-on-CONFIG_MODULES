From: Jeff Mahoney <jeffm@suse.com>
Subject: powerpc: dereference_function_descriptor depends on CONFIG_MODULES

 powerpc64 defines dereference_function_descriptor in
 arch/powerpc/kernel/module_64.c, which isn't built without
 CONFIG_MODULES enabled. This causes compile failures when modules
 aren't enabled.

 This patch makes the declaration depend on CONFIG_MODULES.

Signed-off-by: Jeff Mahoney <jeffm@suse.com>
---
 arch/powerpc/include/asm/sections.h |    2 ++
 1 file changed, 2 insertions(+)

--- a/arch/powerpc/include/asm/sections.h
+++ b/arch/powerpc/include/asm/sections.h
@@ -16,8 +16,10 @@ static inline int in_kernel_text(unsigne
 	return 0;
 }
 
+#ifdef CONFIG_MODULES
 #undef dereference_function_descriptor
 void *dereference_function_descriptor(void *);
+#endif
 
 #endif
 
