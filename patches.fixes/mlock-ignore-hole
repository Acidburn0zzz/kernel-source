diff -u linux/mm/mlock.c-o linux/mm/mlock.c
--- linux/mm/mlock.c-o	2004-05-28 12:30:38.000000000 +0200
+++ linux/mm/mlock.c	2004-05-28 16:46:33.000000000 +0200
@@ -44,6 +44,13 @@
 	if (newflags & VM_LOCKED) {
 		pages = -pages;
 		ret = make_pages_present(start, end);
+		/* Ran into a hole. This should be an error, but 
+		   some users specify too long lengths e.g. for 
+		   file maps. Ignore it for now.
+		   RED-PEN can locked_vm become negative when this happens? 
+		   Hopefully not. */
+		if (ret == -1) 
+			ret = 0;
 	}
 
 	vma->vm_mm->locked_vm -= pages;
