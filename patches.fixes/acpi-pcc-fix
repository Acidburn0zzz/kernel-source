From: Thomas Renninger <trenn@suse.de>
Subject: Fix pcc_acpi unloading
References: 118602

This patch
- fixes an oops when unloading the module (missing input_unregister_device)
- makes the driver actually do something useful

--- linux-2.6.13.orig/drivers/acpi/pcc_acpi.c	2005-09-27 09:04:49.000000000 +0200
+++ linux-2.6.13/drivers/acpi/pcc_acpi.c	2005-09-27 09:09:34.000000000 +0200
@@ -187,10 +187,10 @@
 	acpi_os_free(buffer.pointer);
 	
 	if (status != AE_OK) {
-		return -1;
+		return 0;
 	}
 
-	return 0;
+	return 1;
 }
 
 static int acpi_pcc_read_sinf_field(struct seq_file *seq, int field)
@@ -208,6 +208,7 @@
 		seq_printf(seq, "%u\n",	sinf[field]);
 	}
 	else {
+		seq_printf(seq, "error");
 		printk(PCC_ERR "acpi_pcc_read_sinf_field() could not retrieve \
 				BIOS data\n");
 	}
@@ -878,6 +879,8 @@
 				notify handler\n");
 	}
 
+	input_unregister_device(hotkey->input_dev);
+
 	kfree(hotkey);
 
 	if(status != AE_OK) {
