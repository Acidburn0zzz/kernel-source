#date: 2004-04-14
#id: 1.1371.710.2
#tag: other
#time: 21:04:35
#title: [libata] move some PIO state init to its proper place
#who: jgarzik@redhat.com
#
# ChangeSet
#   1.1371.710.2 04/04/14 21:04:35 jgarzik@redhat.com +2 -0
#   [libata] move some PIO state init to its proper place
#
# drivers/scsi/libata-scsi.c +0 -1
# drivers/scsi/libata-core.c +1 -0
#
diff -Nru a/drivers/scsi/libata-core.c b/drivers/scsi/libata-core.c
--- a/drivers/scsi/libata-core.c	Wed Apr 28 09:35:54 2004
+++ b/drivers/scsi/libata-core.c	Wed Apr 28 09:35:54 2004
@@ -2245,6 +2245,7 @@
 		qc->scsicmd = NULL;
 		qc->ap = ap;
 		qc->dev = dev;
+		qc->cursect = qc->cursg = qc->cursg_ofs = 0;
 		INIT_LIST_HEAD(&qc->node);
 		init_MUTEX_LOCKED(&qc->sem);
 
diff -Nru a/drivers/scsi/libata-scsi.c b/drivers/scsi/libata-scsi.c
--- a/drivers/scsi/libata-scsi.c	Wed Apr 28 09:35:54 2004
+++ b/drivers/scsi/libata-scsi.c	Wed Apr 28 09:35:54 2004
@@ -223,7 +223,6 @@
 	struct ata_taskfile *tf = &qc->tf;
 	unsigned int lba48 = tf->flags & ATA_TFLAG_LBA48;
 
-	qc->cursect = qc->cursg = qc->cursg_ofs = 0;
 	tf->flags |= ATA_TFLAG_ISADDR | ATA_TFLAG_DEVICE;
 	tf->hob_nsect = 0;
 	tf->hob_lbal = 0;
