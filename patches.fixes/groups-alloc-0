Index: linux-2.6.5/kernel/sys.c
===================================================================
--- linux-2.6.5.orig/kernel/sys.c
+++ linux-2.6.5/kernel/sys.c
@@ -1110,8 +1110,9 @@ struct group_info *groups_alloc(int gids
 	int nblocks;
 	int i;
 
-	nblocks = (gidsetsize/NGROUPS_PER_BLOCK) +
-	    (gidsetsize%NGROUPS_PER_BLOCK?1:0);
+	nblocks = (gidsetsize + NGROUPS_PER_BLOCK - 1) / NGROUPS_PER_BLOCK;
+	if (nblocks == 0)
+		nblocks = 1;
 	group_info = kmalloc(sizeof(*group_info) + nblocks*sizeof(gid_t *),
 	    GFP_USER);
 	if (!group_info)
