diff -u linux-2.6.5/mm/policy.c-o linux-2.6.5/mm/policy.c
--- linux-2.6.5/mm/policy.c-o	2004-05-13 11:53:27.000000000 +0200
+++ linux-2.6.5/mm/policy.c	2004-05-13 14:21:03.361110017 +0200
@@ -267,7 +267,7 @@
 	if (!first)
 		return ERR_PTR(-EFAULT);
 	prev = NULL;
-	for (vma = first; vma->vm_start < end; vma = vma->vm_next) {
+	for (vma = first; vma && vma->vm_start < end; vma = vma->vm_next) {
 		if (!vma->vm_next && vma->vm_end < end)
 			return ERR_PTR(-EFAULT);
 		if (prev && prev->vm_end < vma->vm_start)
@@ -334,7 +334,7 @@
 	int err;
 
 	err = 0;
-	for (; vma->vm_start < end; vma = next) {
+	for (; vma && vma->vm_start < end; vma = next) {
 		next = vma->vm_next;
 		if (vma->vm_start < start)
 			err = split_vma(vma->vm_mm, vma, start, 1);
