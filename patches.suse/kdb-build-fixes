From: Jeff Mahoney <jeffm@suse.com>
Subject: kdb: Build fixes

 The includes as provided don't work when building out-of-tree, as we do
 while packaging. Also, struct file->f_count is an atomic_long_t.

Signed-off-by: Jeff Mahoney <jeffm@suse.com>
---
 kdb/modules/kdbm_vm.c |    6 ++++--
 1 file changed, 4 insertions(+), 2 deletions(-)

--- a/kdb/modules/kdbm_vm.c
+++ b/kdb/modules/kdbm_vm.c
@@ -16,7 +16,9 @@
 #include <linux/swap.h>
 #include <linux/swapops.h>
 
-#include <scsi.h>
+#include <scsi/scsi.h>
+#include <scsi/scsi_cmnd.h>
+#include <scsi/scsi_device.h>
 #include <scsi/scsi_host.h>
 #include <asm/pgtable.h>
 
@@ -748,7 +750,7 @@ kdbm_filp(int argc, const char **argv)
 
 	kdb_printf(" f_count = " kdb_f_count_fmt
 			" f_flags = 0x%x f_mode = 0x%x\n",
-			atomic_read(&f.f_count), f.f_flags, f.f_mode);
+			atomic_long_read(&f.f_count), f.f_flags, f.f_mode);
 
 	kdb_printf(" f_pos = %Ld\n", f.f_pos);
 #ifdef	CONFIG_SECURITY
