mason@suse.com

bug #37758

block_write_full_page might see and lock clean metadata buffers, which leads
to journal-1777 messages.  Change the message to ignore bh locked.

Index: linux.t/fs/reiserfs/journal.c
===================================================================
--- linux.t.orig/fs/reiserfs/journal.c	2004-04-01 10:31:37.475834875 -0500
+++ linux.t/fs/reiserfs/journal.c	2004-04-01 10:34:54.825213190 -0500
@@ -2705,7 +2705,7 @@ int journal_mark_dirty(struct reiserfs_t
   ** a dirty or journal_dirty or locked buffer to be logged, as some changes
   ** could get to disk too early.  NOT GOOD.
   */
-  if (!prepared || buffer_locked(bh) || buffer_dirty(bh)) {
+  if (!prepared || buffer_dirty(bh)) {
     reiserfs_warning (p_s_sb, "journal-1777: buffer %llu bad state "
 		      "%cPREPARED %cLOCKED %cDIRTY %cJDIRTY_WAIT",
 		      (unsigned long long)bh->b_blocknr, prepared ? ' ' : '!', 
