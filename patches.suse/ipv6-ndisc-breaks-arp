
This patch fixes a problem with gratuitous ARPs (#40103): If we receive a
gratuitous ARP update for a neighbor cache entry that is in state STALE,
the NEIGH_UPDATE_F_REUSEADDR will cause the old entry not to be updated,
because the state is unchanged. This hurts stuff like HA failover.

I don't understand the purpose of this flag, and believe it is safe
to remove it. --okir

--- linux-2.6.5/net/core/neighbour.c.ndisc	2004-05-06 13:24:24.000000000 +0200
+++ linux-2.6.5/net/core/neighbour.c	2004-05-10 17:18:42.000000000 +0200
@@ -1116,9 +1116,6 @@
 	neigh_hold(neigh);
 	write_lock_bh(&neigh->lock);
 	update = __neigh_update(neigh, lladdr, new, 
-#ifdef CONFIG_IPV6_NDISC_NEW
-				NEIGH_UPDATE_F_REUSEADDR |
-#endif /* CONFIG_IPV6_NDISC_NEW */
 				(override ? NEIGH_UPDATE_F_OVERRIDE : 0) |
 				(arp ? 0 : NEIGH_UPDATE_F_ADMIN));
 #ifdef CONFIG_ARPD
