bug 41270

diff -Naur old/fs/rcfs/dir.c nu/fs/rcfs/dir.c
--- old/fs/rcfs/dir.c	2004-05-24 03:56:41.783369960 -0700
+++ nu/fs/rcfs/dir.c	2004-05-24 03:56:29.265273000 -0700
@@ -174,7 +174,7 @@
  	// create the default set of magic files 
 	clstype = (RCFS_I(dentry->d_inode))->core->classtype;
 	rcfs_create_magic(dentry, &(((struct rcfs_magf*)clstype->mfdesc)[1]), 
-			  clstype->mfcount-1);
+			  clstype->mfcount-2);
 
 	return retval;
 
diff -Naur old/fs/rcfs/tc_magic.c nu/fs/rcfs/tc_magic.c
--- old/fs/rcfs/tc_magic.c	2004-05-24 03:56:41.826363424 -0700
+++ nu/fs/rcfs/tc_magic.c	2004-05-24 04:03:07.644710120 -0700
@@ -61,12 +61,6 @@
 		.i_op    = &rcfs_file_inode_operations,
 	},
 	{ 
-		.name    =  "config", 
-		.mode    = TC_FILE_MODE, 
-		.i_fop   = &config_fileops, 
-		.i_op    = &rcfs_file_inode_operations,
-	},
-	{ 
 		.name    =  "members", 
 		.mode    = TC_FILE_MODE, 
 		.i_fop   = &members_fileops,
@@ -84,6 +78,14 @@
 		.i_fop   = &shares_fileops, 
 		.i_op    = &rcfs_file_inode_operations,
 	},
+	// Config should be made available only at the root level
+	// Make sure this is the last entry, as rcfs_mkdir depends on it
+	{ 
+		.name    =  "config", 
+		.mode    = TC_FILE_MODE, 
+		.i_fop   = &config_fileops, 
+		.i_op    = &rcfs_file_inode_operations,
+	},
 };
 
 struct rcfs_mfdesc tc_mfdesc = {
