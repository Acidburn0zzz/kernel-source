From: Tim Chen <tim.c.chen@linux.intel.com>
Date: Wed, 27 Sep 2017 12:09:14 -0700
Subject: x86/feature: Report presence of IBPB and IBRS control
Patch-mainline: submitted on 2018/1/9
References: bnc#1068032 CVE-2017-5715

Report presence of IBPB and IBRS.

Signed-off-by: Jiri Slaby <jslaby@suse.cz>
---
 arch/x86/kernel/cpu/intel.c | 5 +++++
 1 file changed, 5 insertions(+)

diff --git a/arch/x86/kernel/cpu/intel.c b/arch/x86/kernel/cpu/intel.c
index b720dacac051..ca0eaa9fe83a 100644
--- a/arch/x86/kernel/cpu/intel.c
+++ b/arch/x86/kernel/cpu/intel.c
@@ -628,6 +628,11 @@ static void init_intel(struct cpuinfo_x86 *c)
 	init_intel_energy_perf(c);
 
 	init_intel_misc_features(c);
+
+	if (boot_cpu_has(X86_FEATURE_SPEC_CTRL))
+                printk_once(KERN_INFO "FEATURE SPEC_CTRL Present\n");
+        else
+                printk_once(KERN_INFO "FEATURE SPEC_CTRL Not Present\n");
 }
 
 #ifdef CONFIG_X86_32
-- 
2.15.1

