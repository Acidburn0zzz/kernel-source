--- linux-2.6.5/fs/namei.c.linklim	2004-05-18 12:32:06.000000000 +0200
+++ linux-2.6.5/fs/namei.c	2004-05-18 12:36:10.000000000 +0200
@@ -415,7 +415,7 @@
 static inline int do_follow_link(struct dentry *dentry, struct nameidata *nd)
 {
 	int err = -ELOOP;
-	if (current->link_count >= 5)
+	if (current->link_count >= 8)
 		goto loop;
 	if (current->total_link_count >= 40)
 		goto loop;
--- linux-2.6.5/fs/smbfs/symlink.c.linklim	2004-04-04 05:37:37.000000000 +0200
+++ linux-2.6.5/fs/smbfs/symlink.c	2004-05-18 12:36:07.000000000 +0200
@@ -48,17 +48,22 @@
 
 int smb_follow_link(struct dentry *dentry, struct nameidata *nd)
 {
-	char link[256];		/* FIXME: pain ... */
-	int len;
+	char *link;
+	int len, res;
 	DEBUG1("followlink of %s/%s\n", DENTRY_PATH(dentry));
 
-	len = smb_proc_read_link(server_from_dentry(dentry), dentry, link,
-				 sizeof(link) - 1);
-	if(len < 0)
-		return -ENOENT;
+	if (!(link = kmalloc(256, GFP_KERNEL)))
+		return -ENOMEM;
 
-	link[len] = 0;
-	return vfs_follow_link(nd, link);
+	len = smb_proc_read_link(server_from_dentry(dentry), dentry, link, 255);
+
+	res = -ENOENT;
+	if (len >= 0) {
+		link[len] = 0;
+		res = vfs_follow_link(nd, link);
+	}
+	kfree(link);
+	return res;
 }
 
 
