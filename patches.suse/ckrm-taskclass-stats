BUG 40391, fix a ckrm panic shen writing to stats file

diff -Naur linux.old/fs/rcfs/magic.c linux.new/fs/rcfs/magic.c
--- linux.old/fs/rcfs/magic.c	2004-05-14 05:35:24.459219496 -0700
+++ linux.new/fs/rcfs/magic.c	2004-05-14 05:36:09.104432392 -0700
@@ -101,6 +101,7 @@
 FUNC ## _parse(char *options, char **resstr, char **otherstr)	       \
 {								       \
 	char *p;						       \
+	*resstr = NULL;                                                \
 								       \
 	if (!options)						       \
 		return 1;					       \
@@ -124,7 +125,7 @@
 			return 0;				       \
 		}                                                      \
 	}                                                              \
-	return 1;                                                      \
+	return (*resstr != NULL);                                      \
 }
 
 #define MAGIC_WRITE(FUNC,CLSTYPEFUN)                                   \
diff -Naur linux.old/kernel/ckrm/ckrm.c linux.new/kernel/ckrm/ckrm.c
--- linux.old/kernel/ckrm/ckrm.c	2004-05-14 05:53:12.198898392 -0700
+++ linux.new/kernel/ckrm/ckrm.c	2004-05-14 05:54:07.844438984 -0700
@@ -82,6 +82,9 @@
 {
 	int resid = -1;
 	
+	if (!clstype || !resname) {
+		return NULL;
+	}
 	for (resid=0; resid < clstype->max_resid; resid++) { 
 		if (test_bit(resid, &clstype->bit_res_ctlrs)) {
 			struct ckrm_res_ctlr *rctrl = clstype->res_ctlrs[resid];
