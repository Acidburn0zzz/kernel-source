Subject: Don't use <linux/kdb.h> outside CONFIG_KDB
From: schwab@suse.de
Patch-mainline: never

--- linux-2.6.17/drivers/serial/8250.c.~1~	2006-08-10 18:15:45.000000000 +0200
+++ linux-2.6.17/drivers/serial/8250.c	2006-08-10 18:16:41.000000000 +0200
@@ -45,8 +45,8 @@
 #include <asm/irq.h>
 
 #include "8250.h"
-#include <linux/kdb.h>
 #ifdef	CONFIG_KDB
+#include <linux/kdb.h>
 /*
  * kdb_serial_line records the serial line number of the first serial console.
  * NOTE: The kernel ignores characters on the serial line unless a user space
@@ -57,6 +57,8 @@
 
 static int  kdb_serial_line = -1;
 static const char *kdb_serial_ptr = kdb_serial_str;
+#else
+#define KDB_8250() 0
 #endif	/* CONFIG_KDB */
 
 #ifndef NO_PC_LEGACY_SERIAL_8250
