Subject: Don't use <linux/kdb.h> outside CONFIG_KDB
From: schwab@suse.de
Patch-mainline: never

---
 drivers/serial/8250.c |    4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)

--- a/drivers/serial/8250.c	2007-10-31 17:45:27.000000000 -0400
+++ b/drivers/serial/8250.c	2007-10-31 17:45:31.000000000 -0400
@@ -45,8 +45,8 @@
 #include <asm/irq.h>
 
 #include "8250.h"
-#include <linux/kdb.h>
 #ifdef	CONFIG_KDB
+#include <linux/kdb.h>
 /*
  * kdb_serial_line records the serial line number of the first serial console.
  * NOTE: The kernel ignores characters on the serial line unless a user space
@@ -57,6 +57,8 @@
 
 static int  kdb_serial_line = -1;
 static const char *kdb_serial_ptr = kdb_serial_str;
+#else
+#define KDB_8250() 0
 #endif	/* CONFIG_KDB */
 
 #ifndef NO_PC_LEGACY_SERIAL_8250
