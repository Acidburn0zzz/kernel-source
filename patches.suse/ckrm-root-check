diff -urNp linux-2.6.5/fs/rcfs/magic.c linux-2.6.5.SUSE/fs/rcfs/magic.c
--- linux-2.6.5/fs/rcfs/magic.c	2004-05-14 12:43:47.000000000 +0200
+++ linux-2.6.5.SUSE/fs/rcfs/magic.c	2004-05-14 12:44:00.000000000 +0200
@@ -243,8 +243,8 @@ target_write(struct file *file, const ch
 
 	up(&(ri->vfs_inode.i_sem));
 	kfree(optbuf);
-	return !rc ? count : rc;
 
+	return (!rc ? count : rc);
 }
 
 struct file_operations target_fileops = {
diff -urNp linux-2.6.5/kernel/ckrm/ckrm_tc.c linux-2.6.5.SUSE/kernel/ckrm/ckrm_tc.c
--- linux-2.6.5/kernel/ckrm/ckrm_tc.c	2004-05-14 12:43:47.000000000 +0200
+++ linux-2.6.5.SUSE/kernel/ckrm/ckrm_tc.c	2004-05-14 12:44:00.000000000 +0200
@@ -603,7 +603,13 @@ ckrm_forced_reclassify_pid(pid_t pid, st
 	}
 	get_task_struct(tsk);
 	read_unlock(&tasklist_lock);
-	
+
+	/* Check permissions */
+	if ( (!capable(CAP_SYS_NICE)) &&
+	     (!capable(CAP_SYS_RESOURCE)) &&
+	     (current->user != tsk->user))
+		return -EPERM;
+	    
 	down(&async_serializer);   // protect again race condition
 	
 	ce_protect(&CT_taskclass);
