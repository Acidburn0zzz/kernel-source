Index: linux-2.6.5/kernel/exit.c
===================================================================
--- linux-2.6.5.orig/kernel/exit.c
+++ linux-2.6.5/kernel/exit.c
@@ -30,8 +30,11 @@
 #include <asm/uaccess.h>
 #include <asm/pgtable.h>
 #include <asm/mmu_context.h>
 
+/* tng related changes */
+int (*tng_exitfunc)(int) = NULL;
+
 extern void sem_exit (void);
 extern struct task_struct *child_reaper;
 
 int getrusage(struct task_struct *, int, struct rusage *);
@@ -779,8 +782,11 @@ asmlinkage NORET_TYPE void do_exit(long 
 
 	acct_process(code);
 	__exit_mm(tsk);
 
+	if (unlikely(tng_exitfunc))
+        	(*tng_exitfunc)((int) code);
+
 	exit_sem(tsk);
 	__exit_files(tsk);
 	__exit_fs(tsk);
 	exit_namespace(tsk);
Index: linux-2.6.5/kernel/fork.c
===================================================================
--- linux-2.6.5.orig/kernel/fork.c
+++ linux-2.6.5/kernel/fork.c
@@ -40,8 +40,11 @@
 #include <asm/mmu_context.h>
 #include <asm/cacheflush.h>
 #include <asm/tlbflush.h>
 
+/* tng related changes */
+int (*tng_forkfunc)(struct task_struct *) = NULL;
+
 extern int copy_semundo(unsigned long clone_flags, struct task_struct *tsk);
 extern void exit_sem(struct task_struct *tsk);
 
 /* The idle threads do not count..
@@ -1191,8 +1194,10 @@ long do_fork(unsigned long clone_flags,
 	if (!IS_ERR(p)) {
 		struct completion vfork;
 
 		ckrm_cb_fork(p);
+		if (unlikely(tng_forkfunc))
+			(*tng_forkfunc)((struct task_struct *) p);
 
 		if (clone_flags & CLONE_VFORK) {
 			p->vfork_done = &vfork;
 			init_completion(&vfork);
