diff -uNrp linux-2.6.5/kernel/evlbuf.c linux-2.6.5.evlog/kernel/evlbuf.c
--- linux-2.6.5/kernel/evlbuf.c	2004-06-09 16:08:56.000000000 +0200
+++ linux-2.6.5.evlog/kernel/evlbuf.c	2004-06-09 16:21:57.000000000 +0200
@@ -234,7 +234,11 @@ evl_mk_rechdr(struct kern_log_entry *rec
 	rec_hdr->log_uid		=  current->uid;
 	rec_hdr->log_gid		=  current->gid;
 	rec_hdr->log_pid		=  current->pid;
-	rec_hdr->log_pgrp		=  process_group(current);
+	/* current->signal->xxx pointers may be bad. */
+	if (unlikely(current->flags & PF_EXITING))
+		rec_hdr->log_pgrp 	=  0;
+	else
+		rec_hdr->log_pgrp 	=  process_group(current);
 	rec_hdr->log_flags		=  (__u32) flags;
 	rec_hdr->log_processor		=  (__s32) smp_processor_id();
 
