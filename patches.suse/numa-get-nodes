diff -u linux/mm/policy.c-NODES linux/mm/policy.c
--- linux/mm/policy.c-NODES	2004-06-21 22:27:50.000000000 +0200
+++ linux/mm/policy.c	2004-06-21 22:28:46.000000000 +0200
@@ -130,7 +130,11 @@
 	unsigned long nlongs;
 	unsigned long endmask;
 
-	--maxnode;
+	bitmap_clear(nodes, MAX_NUMNODES);
+	if (maxnode <= 1) 
+		return 0;
+	--maxnode;	
+
 	nlongs = BITS_TO_LONGS(maxnode);
 	if ((maxnode % BITS_PER_LONG) == 0)
 		endmask = ~0UL;
@@ -154,7 +158,6 @@
 		endmask = ~0UL;
 	}
 
-	bitmap_clear(nodes, MAX_NUMNODES);
 	if (nmask && copy_from_user(nodes, nmask, nlongs*sizeof(unsigned long)))
 		return -EFAULT;
 	nodes[nlongs-1] &= endmask;
