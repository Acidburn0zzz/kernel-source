--- linux-2.6.5/arch/i386/kernel/vsyscall-gtod.c	2004-06-16 21:46:45.664714288 +0200
+++ linux-2.6.5.x86/arch/i386/kernel/vsyscall-gtod.c	2004-06-16 21:43:23.873816840 +0200
@@ -182,7 +182,7 @@ static int __vsyscall(0) asmlinkage vget
 	 * just call gettimeofday()
 	 */
 	if (__vsyscall_timesource == VSYSCALL_GTOD_NONE) 
-		return  gettimeofday(tv, tz);
+		return __NR_gettimeofday;
 
 	if (tv)
 		ret = do_vgettimeofday(tv);
--- linux-2.6.5/arch/i386/kernel/vsyscall-int80.S	2004-06-14 03:05:34.000000000 +0200
+++ linux-2.6.5.x86/arch/i386/kernel/vsyscall-int80.S	2004-06-16 21:43:20.750231421 +0200
@@ -18,6 +18,7 @@ __kernel_vsyscall:
 #ifdef CONFIG_VSYSCALL_GTOD
 	cmp $__NR_gettimeofday, %eax
 	je .Lvgettimeofday
+.Lvgettimeofday_disabled:
 #endif /* CONFIG_VSYSCALL_GTOD */
 	int $0x80
 	ret
@@ -32,6 +33,9 @@ __kernel_vsyscall:
 	popl %ebx
 	popl %ecx
 	popl %edx
+	/* don't take the slow path if vgettimeofday is disabled */
+	cmpl $__NR_gettimeofday, %eax
+	je .Lvgettimeofday_disabled
 	ret
 #endif /* CONFIG_VSYSCALL_GTOD */
 
--- linux-2.6.5/arch/i386/kernel/vsyscall-sysenter.S	2004-06-14 03:05:34.000000000 +0200
+++ linux-2.6.5.x86/arch/i386/kernel/vsyscall-sysenter.S	2004-06-16 21:46:22.489852121 +0200
@@ -18,6 +18,7 @@ __kernel_vsyscall:
 #ifdef CONFIG_VSYSCALL_GTOD
 	cmp $__NR_gettimeofday, %eax
 	je .Lvgettimeofday
+.Lvgettimeofday_disabled:
 #endif /* CONFIG_VSYSCALL_GTOD */
 	push %ecx
 .Lpush_ecx:
@@ -54,6 +55,9 @@ SYSENTER_RETURN:
 	popl %ebx
 	popl %ecx
 	popl %edx
+	/* don't take the slow path if vgettimeofday is disabled */
+	cmpl $__NR_gettimeofday, %eax
+	je .Lvgettimeofday_disabled
 	ret
 #endif /* CONFIG_VSYSCALL_GTOD */
 
