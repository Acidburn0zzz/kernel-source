--- linux/fs/open.c.orig	2004-07-12 17:26:48.250564291 +0200
+++ linux/fs/open.c	2004-07-12 17:27:49.988474818 +0200
@@ -673,10 +673,12 @@
 asmlinkage long sys_fchmod(unsigned int fd, mode_t mode)
 {
 	struct file * file;
-	int err = -EBADF;
+	int err;
 
 	FSHOOK_BEGIN(fchmod, err, .fd = fd, .mode = mode)
 
+	err = -EBADF;
+
 	file = fget(fd);
 	if (!file)
 		goto out;
