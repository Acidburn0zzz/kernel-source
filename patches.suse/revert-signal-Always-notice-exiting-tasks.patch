From: Jiri Slaby <jslaby@suse.cz>
Date: Tue, 19 Feb 2019 07:31:53 +0100
Subject: Revert "signal: Always notice exiting tasks"
Patch-mainline: not yet, under discussion
References: strace threads-execve regression

This reverts commit 1ab370e1385374f99386267d63a7af062ba06bd1, upstream
commit 35634ffa1751b6efd8cf75010b509dcb0263e29b as it breaks strace.
See:
https://github.com/strace/strace/commit/2a50278b9#commitcomment-32367006

Signed-off-by: Jiri Slaby <jslaby@suse.cz>
---
 kernel/signal.c |    6 ------
 1 file changed, 6 deletions(-)

--- a/kernel/signal.c
+++ b/kernel/signal.c
@@ -2435,11 +2435,6 @@ relock:
 		goto relock;
 	}
 
-	/* Has this task already been marked for death? */
-	ksig->info.si_signo = signr = SIGKILL;
-	if (signal_group_exit(signal))
-		goto fatal;
-
 	for (;;) {
 		struct k_sigaction *ka;
 
@@ -2543,7 +2538,6 @@ relock:
 			continue;
 		}
 
-	fatal:
 		spin_unlock_irq(&sighand->siglock);
 
 		/*
