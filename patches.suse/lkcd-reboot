diff -Naurp before/arch/i386/kernel/smp.c after/arch/i386/kernel/smp.c
--- before/arch/i386/kernel/smp.c	2004-05-03 23:18:17.000000000 +0530
+++ after/arch/i386/kernel/smp.c	2004-05-13 04:30:54.039774208 +0530
@@ -622,6 +622,8 @@ void smp_send_stop(void)
 	local_irq_enable();
 }
 
+EXPORT_SYMBOL(smp_send_stop);
+
 /*
  * Reschedule call back. Nothing to do,
  * all the work is done automatically when
diff -Naurp before/arch/ppc64/kernel/smp.c after/arch/ppc64/kernel/smp.c
--- before/arch/ppc64/kernel/smp.c	2004-05-03 23:18:23.000000000 +0530
+++ after/arch/ppc64/kernel/smp.c	2004-05-13 04:32:59.986627376 +0530
@@ -695,6 +695,8 @@ void smp_send_stop(void)
 	smp_call_function(stop_this_cpu, NULL, 1, 0);
 }
 
+EXPORT_SYMBOL(smp_send_stop);
+
 /*
  * Structure and data for smp_call_function(). This is designed to minimise
  * static memory requirements. It also looks cleaner.
diff -Naurp before/arch/x86_64/kernel/smp.c after/arch/x86_64/kernel/smp.c
--- before/arch/x86_64/kernel/smp.c	2004-05-03 23:18:23.000000000 +0530
+++ after/arch/x86_64/kernel/smp.c	2004-05-13 04:32:30.596095416 +0530
@@ -487,6 +487,8 @@ void smp_send_stop(void)
 	smp_stop_cpu();
 }
 
+EXPORT_SYMBOL(smp_send_stop);
+
 /*
  * Reschedule call back. Nothing to do,
  * all the work is done automatically when
diff -Naurp before/drivers/dump/dump_execute.c after/drivers/dump/dump_execute.c
--- before/drivers/dump/dump_execute.c	2004-05-03 23:18:25.000000000 +0530
+++ after/drivers/dump/dump_execute.c	2004-05-13 04:25:52.515612848 +0530
@@ -81,6 +81,10 @@ int dump_complete(void)
 	ret = dump_dev_resume();
 
 	if ((panic_timeout > 0) && (!(dump_config.flags & (DUMP_FLAGS_SOFTBOOT | DUMP_FLAGS_NONDISRUPT)))) {
+		printk(KERN_EMERG "Rebooting in %d seconds..",panic_timeout);
+#ifdef CONFIG_SMP
+		smp_send_stop();
+#endif
 		mdelay(panic_timeout * 1000);
 		machine_restart(NULL);
 	}
