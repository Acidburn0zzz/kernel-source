From: garloff@suse.de
Subject: Introduce own timeout for TEST_UNIT_READY

The sense timeout may be too short for T_U_R.

Index: linux-2.6.10/drivers/scsi/scsi_error.c
===================================================================
--- linux-2.6.10.orig/drivers/scsi/scsi_error.c
+++ linux-2.6.10/drivers/scsi/scsi_error.c
@@ -36,8 +36,9 @@
 #include "scsi_logging.h"
 
 #define SENSE_TIMEOUT		(10*HZ)
 #define START_UNIT_TIMEOUT	(30*HZ)
+#define TEST_UNIT_READY_TIMEOUT	(30*HZ)
 
 /*
  * These should *probably* be handled by the host itself.
  * Since it is allowed to sleep, it probably should.
@@ -785,9 +787,9 @@ retry_tur:
 	scmd->cmd_len = COMMAND_SIZE(scmd->cmnd[0]);
 	scmd->underflow = 0;
 	scmd->sc_data_direction = DMA_NONE;
 
-	rtn = scsi_send_eh_cmnd(scmd, SENSE_TIMEOUT);
+	rtn = scsi_send_eh_cmnd(scmd, TEST_UNIT_READY_TIMEOUT);
 
 	/*
 	 * when we eventually call scsi_finish, we really wish to complete
 	 * the original request, so let's restore the original data. (db)
