diff -p -purN linuxppc64-2.5.orig/arch/ppc64/kernel/process.c linuxppc64-2.5/arch/ppc64/kernel/process.c
--- linuxppc64-2.5.orig/arch/ppc64/kernel/process.c	2003-10-09 14:34:24.000000000 +0200
+++ linuxppc64-2.5/arch/ppc64/kernel/process.c	2003-12-14 22:26:59.000000000 +0100
@@ -389,12 +389,8 @@ unsigned long get_wchan(struct task_stru
 			return 0;
 		if (count > 0) {
 			ip = *(unsigned long *)(sp + 16);
-			/*
-			 * XXX we mask the upper 32 bits until procps
-			 * gets fixed.
-			 */
 			if (ip < first_sched || ip >= last_sched)
-				return (ip & 0xFFFFFFFF);
+				return ip;
 		}
 	} while (count++ < 16);
 	return 0;
