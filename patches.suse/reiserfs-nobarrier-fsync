make sure that reiserfs only triggers barriers when mounted with
-o barrier=flush

Index: linux.t/fs/reiserfs/file.c
===================================================================
--- linux.t.orig/fs/reiserfs/file.c	2004-05-31 09:48:13.160069320 -0400
+++ linux.t/fs/reiserfs/file.c	2004-05-31 10:06:46.148869304 -0400
@@ -131,7 +131,7 @@ static int reiserfs_sync_file(
   reiserfs_write_lock(p_s_inode->i_sb);
   barrier_done = reiserfs_commit_for_inode(p_s_inode);
   reiserfs_write_unlock(p_s_inode->i_sb);
-  if (barrier_done != 1)
+  if (barrier_done != 1 && reiserfs_barrier_flush(p_s_inode->i_sb))
       blkdev_issue_flush(p_s_inode->i_sb->s_bdev, NULL);
   if (barrier_done < 0)
     return barrier_done;
