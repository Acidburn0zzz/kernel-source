--- linux-2.6.7/arch/mips/sibyte/sb1250/bcm1250_tbprof.c	2004-06-16 21:10:18.000000000 +0100
+++ linux-2.6.7-viroized/arch/mips/sibyte/sb1250/bcm1250_tbprof.c	2004-06-27 17:51:51.726781712 +0100
@@ -300,6 +300,9 @@
 	int   count   =	 0;
 	char *dest    =	 buf;
 	long  cur_off = *offp;
+	
+	if(curr_off < 0)
+		return -EINVAL;
 
 	count = 0;
 	cur_sample = cur_off / TB_SAMPLE_SIZE;
