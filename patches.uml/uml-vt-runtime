Subject: use runtime-switchable vt for uml
From: kraxel@suse.de
Patch-mainline: lets talk about that once xen-vt-runtime is merged

$subject says all ...

Index: linux-2.6.10/arch/um/drivers/x11_kern.c
===================================================================
--- linux-2.6.10.orig/arch/um/drivers/x11_kern.c	2005-01-25 11:43:49.000000000 +0100
+++ linux-2.6.10/arch/um/drivers/x11_kern.c	2005-01-25 16:32:40.195919679 +0100
@@ -537,7 +537,12 @@ static int x11_setup(char *str)
 {
 	if (3 == sscanf(str,"%dx%d@%d",&x11_width,&x11_height,&x11_fps) ||
 	    2 == sscanf(str,"%dx%d",&x11_width,&x11_height)) {
+#if defined(CONFIG_DUMMY_CONSOLE)
+		printk("%s: console_use_vt=1\n",__FUNCTION__);
+		console_use_vt = 1;
 		x11_enable = 1;
+		conswitchp = &dummy_con;
+#endif  
 		return 0;
 	}
 	return -1;
Index: linux-2.6.10/arch/um/kernel/um_arch.c
===================================================================
--- linux-2.6.10.orig/arch/um/kernel/um_arch.c	2005-01-25 11:43:49.000000000 +0100
+++ linux-2.6.10/arch/um/kernel/um_arch.c	2005-01-25 16:33:11.715792079 +0100
@@ -439,7 +439,8 @@ void __init setup_arch(char **cmdline_p)
  	*cmdline_p = command_line;
 	setup_hostinfo();
 #if defined(CONFIG_DUMMY_CONSOLE)
-	conswitchp = &dummy_con;
+	printk("%s: console_use_vt=0\n",__FUNCTION__);
+	console_use_vt = 0;
 #endif  
 }
 
