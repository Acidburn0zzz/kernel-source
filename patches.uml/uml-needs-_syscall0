Subject: Fix uml build with 2.6.18+ kernel headers.
From: kraxel@suse.de

Someone wrapped the syscall defines into #ifdef __KERNEL__,
breaking the uml kernel build.  Workaround that.

---
 arch/um/os-Linux/process.c |    8 +++++++-
 1 files changed, 7 insertions(+), 1 deletion(-)

--- linux-2.6.18.orig/arch/um/os-Linux/process.c
+++ linux-2.6.18/arch/um/os-Linux/process.c
@@ -3,6 +3,10 @@
  * Licensed under the GPL
  */
 
+#define __KERNEL__ /* need _syscall0 */
+#include <asm/unistd.h>
+#undef __KERNEL__
+
 #include <unistd.h>
 #include <stdio.h>
 #include <errno.h>
@@ -141,9 +145,11 @@ void os_usr1_process(int pid)
  * syscalls, and also breaks with clone(), which does not unshare the TLS.
  */
 
+inline _syscall0(pid_t, getpid)
+
 int os_getpid(void)
 {
-	return syscall(__NR_getpid);
+	return(getpid());
 }
 
 int os_getpgrp(void)
