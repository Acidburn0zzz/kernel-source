Index: uml-2.6.9-rc2/arch/um/include/skas_ptrace.h
===================================================================
--- uml-2.6.9-rc2.orig/arch/um/include/skas_ptrace.h	2004-09-16 16:10:16.000000000 +0200
+++ uml-2.6.9-rc2/arch/um/include/skas_ptrace.h	2004-09-16 16:10:24.000000000 +0200
@@ -6,6 +6,7 @@
 #ifndef __SKAS_PTRACE_H
 #define __SKAS_PTRACE_H
 
+#ifndef PTRACE_FAULTINFO
 struct ptrace_faultinfo {
 	int is_write;
 	unsigned long addr;
@@ -21,6 +22,7 @@ struct ptrace_ldt {
 #define PTRACE_SIGPENDING 53
 #define PTRACE_LDT 54
 #define PTRACE_SWITCH_MM 55
+#endif
 
 #endif
 
Index: uml-2.6.9-rc2/kernel/fork.c
===================================================================
--- uml-2.6.9-rc2.orig/kernel/fork.c	2004-09-16 16:10:21.000000000 +0200
+++ uml-2.6.9-rc2/kernel/fork.c	2004-09-16 16:12:40.000000000 +0200
@@ -1038,7 +1038,9 @@ static task_t *copy_process(unsigned lon
 	 * of CLONE_PTRACE.
 	 */
 	clear_tsk_thread_flag(p, TIF_SYSCALL_TRACE);
+#ifdef TIF_SYSCALL_EMU
 	clear_tsk_thread_flag(p, TIF_SYSCALL_EMU);
+#endif
 
 	/* Our parent execution domain becomes current domain
 	   These must match for thread signalling to apply */
