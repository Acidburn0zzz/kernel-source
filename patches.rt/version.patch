Subject: add -rt extra-version
From: Ingo Molnar <mingo@elte.hu>

add -rt extra-version.

Signed-off-by: Ingo Molnar <mingo@elte.hu>
Signed-off-by: Thomas Gleixner <tglx@linutronix.de>
---
 Makefile           |    2 +-
 arch/i386/Makefile |    4 ++--
 kernel/fork.c      |    1 -
 3 files changed, 3 insertions(+), 4 deletions(-)

Index: linux-rt.q/Makefile
===================================================================
--- linux-rt.q.orig/Makefile
+++ linux-rt.q/Makefile
@@ -1,7 +1,7 @@
 VERSION = 2
 PATCHLEVEL = 6
 SUBLEVEL = 22
-EXTRAVERSION = .1-cfs-v19
+EXTRAVERSION = .1-rt9
 NAME = Holy Dancing Manatees, Batman!
 
 # *DOCUMENTATION*
Index: linux-rt.q/arch/i386/Makefile
===================================================================
--- linux-rt.q.orig/arch/i386/Makefile
+++ linux-rt.q/arch/i386/Makefile
@@ -31,7 +31,7 @@ LDFLAGS_vmlinux := --emit-relocs
 endif
 CHECKFLAGS	+= -D__i386__
 
-CFLAGS += -pipe -msoft-float
+CFLAGS += -pipe -msoft-float -freg-struct-return
 
 # prevent gcc from keeping the stack 16 byte aligned
 CFLAGS += $(call cc-option,-mpreferred-stack-boundary=2)
@@ -39,7 +39,7 @@ CFLAGS += $(call cc-option,-mpreferred-s
 # CPU-specific tuning. Anything which can be shared with UML should go here.
 include $(srctree)/arch/i386/Makefile.cpu
 
-cflags-$(CONFIG_REGPARM) += -mregparm=3 -freg-struct-return
+cflags-$(CONFIG_REGPARM) += -mregparm=3
 
 # temporary until string.h is fixed
 cflags-y += -ffreestanding
Index: linux-rt.q/kernel/fork.c
===================================================================
--- linux-rt.q.orig/kernel/fork.c
+++ linux-rt.q/kernel/fork.c
@@ -132,7 +132,6 @@ void __put_task_struct_cb(struct rcu_hea
 	BUG_ON(atomic_read(&tsk->usage));
 	WARN_ON(!(tsk->exit_state & (EXIT_DEAD | EXIT_ZOMBIE)));
 	WARN_ON(tsk == current);
-	sched_dead(tsk);
 
 	security_task_free(tsk);
 	free_uid(tsk->user);
