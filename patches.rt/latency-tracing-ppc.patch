Subject: Linux-RT 2.6.24-rc2-rt1
From: http://www.kernel.org/pub/linux/kernel/projects/rt/
Acked-by: Sven-Thorsten Dietrich <sdietrich@suse.de>
 arch/powerpc/kernel/time.c |    1 +
 arch/ppc/boot/Makefile     |    9 +++++++++
 2 files changed, 10 insertions(+)

Index: linux-2.6.24-rc2-rt1/arch/powerpc/kernel/time.c
===================================================================
--- linux-2.6.24-rc2-rt1.orig/arch/powerpc/kernel/time.c
+++ linux-2.6.24-rc2-rt1/arch/powerpc/kernel/time.c
@@ -908,6 +908,7 @@ void __init time_init(void)
 	tb_ticks_per_jiffy = ppc_tb_freq / HZ;
 	tb_ticks_per_sec = ppc_tb_freq;
 	tb_ticks_per_usec = ppc_tb_freq / 1000000;
+	cpu_khz  = ppc_tb_freq / 1000;
 	tb_to_us = mulhwu_scale_factor(ppc_tb_freq, 1000000);
 	calc_cputime_factors();
 
Index: linux-2.6.24-rc2-rt1/arch/ppc/boot/Makefile
===================================================================
--- linux-2.6.24-rc2-rt1.orig/arch/ppc/boot/Makefile
+++ linux-2.6.24-rc2-rt1/arch/ppc/boot/Makefile
@@ -15,6 +15,15 @@
 
 # KBUILD_CFLAGS used when building rest of boot (takes effect recursively)
 KBUILD_CFLAGS 	+= -fno-builtin -D__BOOTER__ -Iarch/$(ARCH)/boot/include
+
+ifdef CONFIG_MCOUNT
+# do not trace the boot loader
+nullstring :=
+space      := $(nullstring) # end of the line
+pg_flag     = $(nullstring) -pg # end of the line
+KBUILD_CFLAGS     := $(subst ${pg_flag},${space},${KBUILD_CFLAGS})
+endif
+
 HOSTCFLAGS	+= -Iarch/$(ARCH)/boot/include
 
 BOOT_TARGETS	= zImage zImage.initrd znetboot znetboot.initrd
