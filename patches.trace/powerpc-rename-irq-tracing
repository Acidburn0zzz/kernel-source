From: Jeff Mahoney <jeffm@suse.com>
Subject: powerpc: rename irq tracing

 powerpc has separate irq tracing from that used in kernel/. This patch
 renames it to powerpc_irq_entry.

 This may not be the correct fix, but it fixes a multiply-defined
 build failure.

Signed-off-by: Jeff Mahoney <jeffm@suse.com>
---
 arch/powerpc/include/asm/trace.h |    5 +++--
 arch/powerpc/kernel/irq.c        |    7 ++++---
 2 files changed, 7 insertions(+), 5 deletions(-)

--- a/arch/powerpc/include/asm/trace.h
+++ b/arch/powerpc/include/asm/trace.h
@@ -5,10 +5,11 @@
 #define _TRACE_POWERPC_H
 
 #include <linux/tracepoint.h>
+#include <trace/irq.h>
 
 struct pt_regs;
 
-TRACE_EVENT(irq_entry,
+TRACE_EVENT(powerpc_irq_entry,
 
 	TP_PROTO(struct pt_regs *regs),
 
@@ -25,7 +26,7 @@ TRACE_EVENT(irq_entry,
 	TP_printk("pt_regs=%p", __entry->regs)
 );
 
-TRACE_EVENT(irq_exit,
+TRACE_EVENT(powerpc_irq_exit,
 
 	TP_PROTO(struct pt_regs *regs),
 
--- a/arch/powerpc/kernel/irq.c
+++ b/arch/powerpc/kernel/irq.c
@@ -54,6 +54,7 @@
 #include <linux/pci.h>
 #include <linux/debugfs.h>
 #include <linux/perf_event.h>
+#include <linux/ftrace.h>
 
 #include <asm/uaccess.h>
 #include <asm/system.h>
@@ -337,12 +338,12 @@ static inline void check_stack_overflow(
 #endif
 }
 
-void do_IRQ(struct pt_regs *regs)
+void __irq_entry do_IRQ(struct pt_regs *regs)
 {
 	struct pt_regs *old_regs = set_irq_regs(regs);
 	unsigned int irq;
 
-	trace_irq_entry(regs);
+	trace_powerpc_irq_entry(regs);
 
 	irq_enter();
 
@@ -368,7 +369,7 @@ void do_IRQ(struct pt_regs *regs)
 	}
 #endif
 
-	trace_irq_exit(regs);
+	trace_powerpc_irq_exit(regs);
 }
 
 void __init init_IRQ(void)
