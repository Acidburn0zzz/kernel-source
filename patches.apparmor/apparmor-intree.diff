Index: linux-2.6.20/security/Kconfig
===================================================================
--- linux-2.6.20.orig/security/Kconfig
+++ linux-2.6.20/security/Kconfig
@@ -94,6 +94,7 @@ config SECURITY_ROOTPLUG
 	  If you are unsure how to answer this question, answer N.
 
 source security/selinux/Kconfig
+source security/apparmor/Kconfig
 
 endmenu
 
Index: linux-2.6.20/security/Makefile
===================================================================
--- linux-2.6.20.orig/security/Makefile
+++ linux-2.6.20/security/Makefile
@@ -4,6 +4,7 @@
 
 obj-$(CONFIG_KEYS)			+= keys/
 subdir-$(CONFIG_SECURITY_SELINUX)	+= selinux
+subdir-$(CONFIG_SECURITY_APPARMOR)	+= apparmor
 
 # We always need commoncap as it's default
 obj-y		+= commoncap.o
@@ -12,5 +13,8 @@ obj-y		+= commoncap.o
 obj-$(CONFIG_SECURITY)			+= security.o dummy.o inode.o
 # Must precede capability.o in order to stack properly.
 obj-$(CONFIG_SECURITY_SELINUX)		+= selinux/built-in.o
+ifeq ($(CONFIG_SECURITY_APPARMOR),y)
+obj-y					+= apparmor/built-in.o
+endif
 obj-$(CONFIG_SECURITY_CAPABILITIES)	+= capability.o
 obj-$(CONFIG_SECURITY_ROOTPLUG)		+= root_plug.o
