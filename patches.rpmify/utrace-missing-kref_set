From: Jeff Mahoney <jeffm@suse.com>
Subject: [PATCH] utrace: kref_set does not exist
Patch-mainline: probably never. i expect kref_set will get imported.

 The utrace code calls kref_set to initialize the kref to 2. That function
 doesn't (yet) exist in mainline, so the build fails.

 This patch just initializes it and does a get on it.

Signed-off-by: Jeff Mahoney <jeffm@suse.com>
---
 kernel/utrace.c |    3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

--- a/kernel/utrace.c
+++ b/kernel/utrace.c
@@ -250,7 +250,8 @@ struct utrace_engine *utrace_attach_task
 	 * Initialize the new engine structure.  It starts out with two
 	 * refs: one ref to return, and one ref for being attached.
 	 */
-	kref_set(&engine->kref, 2);
+	kref_init(&engine->kref);
+	kref_get(&engine->kref);
 	engine->flags = 0;
 	engine->ops = ops;
 	engine->data = data;
