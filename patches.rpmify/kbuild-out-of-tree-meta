Index: linux-2.6.0/scripts/Makefile.modpost
===================================================================
--- linux-2.6.0.orig/scripts/Makefile.modpost	2004-01-05 15:31:26.458342142 +0100
+++ linux-2.6.0/scripts/Makefile.modpost	2004-01-05 15:28:08.840162674 +0100
@@ -52,13 +52,15 @@ $(modules:.ko=.mod.c): __modpost ;
 # Extract all checksums for all exported symbols
 
 ifeq ($(origin SUBDIRS),command line)
-modver_file := $(wildcard modversions)
+modver_file := $(firstword $(wildcard \
+			     modversions.$(CONFIG_CFGNAME) modversions))
 quiet_cmd_modpost = MODPOST
       cmd_modpost = scripts/modpost $^ $(if $(modver_file),-i $(modver_file))
+
 __modpost: $(modules:.ko=.o)
 	$(call exec_cmd,modpost)
 else
-modver_file := modversions
+modver_file := modversions.$(CONFIG_CFGNAME)
 quiet_cmd_modpost = MODPOST
       cmd_modpost = scripts/modpost $(filter-out FORCE,$^) -o $(modver_file)
 __modpost: $(wildcard vmlinux) $(modules:.ko=.o) FORCE
