A few minor things that are easily fixed prevent building externel
kernel modules against a read-only kernel source tree: (1) it makes no
sense to add out-of-tree modules to the list of modules in .tmp_versions
(=MODVERDIR); (2) create temporary files of filechk outside the kernel
source tree.

Index: linux-2.6.0-test11/Makefile
===================================================================
--- linux-2.6.0-test11.orig/Makefile	2003-12-12 23:50:50.000000000 +0100
+++ linux-2.6.0-test11/Makefile	2003-12-15 21:26:44.725180950 +0100
@@ -592,12 +592,12 @@
 ifdef KBUILD_MODULES
 ifeq ($(origin SUBDIRS),file)
 	$(Q)rm -rf $(MODVERDIR)
+	$(if $(CONFIG_MODULES),$(Q)mkdir -p $(MODVERDIR))
 else
 	@echo '*** Warning: Overriding SUBDIRS on the command line can cause'
 	@echo '***          inconsistencies'
 endif
 endif
-	$(if $(CONFIG_MODULES),$(Q)mkdir -p $(MODVERDIR))
 
 # All the preparing..
 prepare-all: prepare0 prepare
@@ -1010,12 +1010,13 @@
 	@set -e;				\
 	echo '  CHK     $@';			\
 	mkdir -p $(dir $@);			\
-	$(filechk_$(1)) < $< > $@.tmp;		\
-	if [ -r $@ ] && cmp -s $@ $@.tmp; then	\
-		rm -f $@.tmp;			\
+	tmp=$$(/bin/mktemp /tmp/kbuild.XXXXXX);	\
+	$(filechk_$(1)) < $< > $$tmp;		\
+	if [ -r $@ ] && cmp -s $@ $$tmp; then	\
+		rm -f $$tmp;			\
 	else					\
 		echo '  UPD     $@';		\
-		mv -f $@.tmp $@;		\
+		mv -f $$tmp $@;		\
 	fi
 endef
 
