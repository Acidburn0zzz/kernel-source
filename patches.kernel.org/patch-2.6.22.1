Subject: Linux 2.6.22.1
From: Greg Kroah-Hartman <gregkh@suse.de>

Signed-off-by: Greg Kroah-Hartman <gregkh@suse.de>

---
 Makefile                                |    2 +-
 net/netfilter/nf_conntrack_proto_sctp.c |    3 ++-
 2 files changed, 3 insertions(+), 2 deletions(-)

--- a/Makefile	2007-07-08 19:32:17.000000000 -0400
+++ b/Makefile	2007-08-27 14:04:35.000000000 -0400
@@ -1,7 +1,7 @@
 VERSION = 2
 PATCHLEVEL = 6
 SUBLEVEL = 22
-EXTRAVERSION =
+EXTRAVERSION = .1
 NAME = Holy Dancing Manatees, Batman!
 
 # *DOCUMENTATION*
--- a/net/netfilter/nf_conntrack_proto_sctp.c	2007-07-08 19:32:17.000000000 -0400
+++ b/net/netfilter/nf_conntrack_proto_sctp.c	2007-08-27 14:01:19.000000000 -0400
@@ -460,7 +460,8 @@ static int sctp_new(struct nf_conn *conn
 					 SCTP_CONNTRACK_NONE, sch->type);
 
 		/* Invalid: delete conntrack */
-		if (newconntrack == SCTP_CONNTRACK_MAX) {
+		if (newconntrack == SCTP_CONNTRACK_NONE ||
+		    newconntrack == SCTP_CONNTRACK_MAX) {
 			DEBUGP("nf_conntrack_sctp: invalid new deleting.\n");
 			return 0;
 		}
